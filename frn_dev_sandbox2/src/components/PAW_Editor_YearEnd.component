<apex:component allowDML="true">
    <apex:attribute name="c" type="PAW_YearEnd_Controller" description=""/>


    <style>
        .bEditBlock input, .bEditBlock select, .quickCreateModule input, .quickCreateModule select  {
            vertical-align: middle;
            margin-right: 1.40em;
        }

        .bPageBlock .lookupIcon, .bPageBlock .lookupIconOn, .genericPageBlockTable .lookupIcon, .genericPageBlockTable .lookupIconOn {
            vertical-align: middle;
            padding-bottom: 1px;
            margin-left: -115px;
        }

        .apexp .bPageBlock .detailList {
            width: 95%;
        }

        .editPage .bPageBlock .detailList tr th {
            border-bottom: none;
            left: 1.40em;
        }

        .move-button-panel-top {
            position: absolute;
            margin-top: -50px;
            margin-left: 45%;
        }

        .editPage .pbBody {
            margin-top: 20px !important;
        }

        .message {
            margin-bottom: 40px;
        }
    </style>


    <div class="paw_editor container">
        <apex:sectionHeader title="Pay Agreement Worksheet {!c.year}" />
        <apex:form style="width:100%;">
            <apex:outputPanel id="ErrorMessage">
                <apex:pagemessages />
            </apex:outputPanel>

            <apex:pageBlock mode="Edit" id="ac" tabStyle="Pay_Agreement_Worksheet__c">

            <!-- <apex:outputPanel styleClass="target-edr" html-target-edr="{!c.wrprObj.targetEDR}" /> -->

            <apex:outputPanel id="btns">
                <div align="center" draggable="false" class="move-button-panel-top" >
                    <apex:actionFunction namespace="paw{!c.year}"
                                         name="eventListnerAction"
                                         action="{!c.createDetailRecordsForPAW}"
                                         reRender="WorksheetDetail,
                                                   ErrorMessage,
                                                   btns,
                                                   locVal,
                                                   patDel,
                                                   patDel1"
                                         oncomplete="frn.loadAccordian();"
                                            />
                    <apex:commandButton styleClass="updateDetailBtn"
                                        value="Update Details"
                                        rerender="abc"
                                        onmousedown="updateEvent(); return false;"
                                             />

                   <input type="button" class="btn" onclick="frn.onSaveDetails();" id="saveDetails" value="Save"/>
                    <apex:commandButton value="Cancel" action="{!c.cancel}" />
                </div>
            </apex:outputPanel>

                <apex:actionfunction namespace="paw{!c.year}"
                                     name="ptntInsrncSelected"
                                     action="{!c.onPatientSelection}"
                                     reRender="patDel"/>
                <apex:actionfunction namespace="paw{!c.year}"
                                     name="insrncBnftSelected"
                                     action="{!c.onBenefitSelection}"
                                     reRender="patDel,ErrorMessage"/>
                <apex:actionfunction namespace="paw{!c.year}"
                                     name="faciltySelected"
                                     action="{!c.onFacilitySelection}"
                                     reRender="patDel,patDel1,ErrorMessage"/>
                <apex:actionfunction namespace="paw{!c.year}"
                                     name="rateSelected"
                                     action="{!c.updateWraperValues}"
                                     reRender="patDel,locVal,patDel1,ErrorMessage"/>
                <apex:actionfunction namespace="paw{!c.year}"
                                     name="fcltyPrgrmSelected"
                                     action="{!c.updateWraperValues}"
                                     reRender="locVal,ErrorMessage"/>
                <apex:actionfunction namespace="paw{!c.year}"
                                     name="saveClicked"
                                     action="{!c.savePAWRecords}"
                                     reRender="WorksheetDetail,ErrorMessage"
                                     oncomplete="frn.saveCalling(true, '{!c.year}');" />

                <apex:pageBlockSection columns="2" id="patDel">
                    <apex:pageBlockSectionItem rendered="{!c.showPILookup}">
                        <apex:outputLabel value="Patient Insurancexyz"/>
                        <apex:inputField id="patientInsurancePicklist"
                                         value="{!c.wrprObj.pyAgrmntWrksht.Patient_Insurance__c}"
                                         onchange="call('{!c.year}','ptntInsrncSelected');"
                                         style="width:140px;margin-right: 119px;"
                                         />
                    </apex:pageBlockSectionItem>

                    <apex:pageBlockSectionItem rendered="{! NOT(c.showPILookup) }">
                        <apex:outputLabel value="Patient Insurance123"/>
                            <apex:outputPanel >
                                <apex:outputText value="{!c.ptntInsrncObj.Name}" rendered="{!c.ptntInsrncObj.Name!=null}" styleClass="pntntInsrncSelected1"/> 
                                <apex:selectList value="{!c.wrprObj.pyAgrmntWrksht.Patient_Insurance__c}"
                                                 size="1"
                                                 rendered="{!c.ptntInsrncObj.Name==null}"
                                                 multiselect="false" onchange="call('{!c.year}','ptntInsrncSelected');"
                                                 styleClass="pntntInsrncSelected" >
                                    <apex:selectOptions value="{!c.ptntInsrnceSelectOptions}"/>
                                </apex:selectList>
                            </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="Insurance Benefit"/>
                        <apex:selectList value="{!c.wrprObj.insrncBnftSelected}" 
                                         size="1" 
                                         multiselect="false"
                                         onchange=" call('{!c.year}','insrncBnftSelected');"
                                         styleClass="insrncBnftSelected">
                            <apex:selectOptions value="{!c.insrncBnftSelectOptions}"/>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="FRN Facility"/>
                        <apex:selectList value="{!c.wrprObj.facilitySelected}" 
                                         size="1" 
                                         multiselect="false"
                                         onchange=" call('{!c.year}','faciltySelected'); " 
                                         styleClass="frnFacilitySelected">
                            <apex:selectOptions value="{!c.faciltyOptions}"/>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="Rate Adjustment Type"/>
                        <apex:selectList value="{!c.wrprObj.rateAdjstmntSelected}" 
                                         size="1" 
                                         multiselect="false"
                                         onchange=" call('{!c.year}','rateSelected');"
                                         styleClass="rtAdjstmntSelected">
                            <apex:selectOptions value="{!c.rtAdjstmntOptions}"/>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="fpName">
                        <apex:outputText value="Facility Program Name"/>
                        <apex:selectList value="{!c.wrprObj.fcltyPrgrmSelected}" 
                                         size="1" 
                                         multiselect="false"
                                         onchange=" call('{!c.year}','fcltyPrgrmSelected');"
                                         styleClass="fcltyPrgrmSelected">
                            <apex:selectOptions value="{!c.fcltyPrgrmOptions}"/>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="Deductible Included in OOP"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Deductible_Included_in_OOP__c}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="Counter Offer"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Counter_Offer__c}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem >
                        <apex:inputHidden value="{!c.isTalbott}" html-Class="isTalbottCls"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:inputHidden value="{!c.isIop}" html-Class="isIopCls"/>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>

                <apex:pageBlockSection columns="4" id="locVal" html-class="pawData">
                    <!-- Row 1 -->
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="Deductible"/>
                        <apex:outputPanel >
                            <apex:outputField value="{!c.wrprObj.insrncBnft.Deductible__c}" rendered="{!c.wrprObj.insrncBnft.Deductible__c!=null}"/>
                            <apex:outputText value="$0.00" rendered="{!c.wrprObj.insrncBnft.Deductible__c==null}"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="Out&nbsp;of&nbsp;Pocket&nbsp;Max" escape="false"/>
                        <apex:outputPanel >
                            <apex:outputField value="{!c.wrprObj.insrncBnft.Max_Out_of_Pocket__c}" rendered="{!c.wrprObj.insrncBnft.Max_Out_of_Pocket__c!=null}"/>
                            <apex:outputText value="$0.00" rendered="{!c.wrprObj.insrncBnft.Max_Out_of_Pocket__c==null}"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="Deductible&nbsp;Amount&nbsp;Requested" escape="false"/>
                        <apex:inputField value="{!c.wrprObj.pyAgrmntWrksht.Deductible_Amount_Requested__c}" style="width:120px;"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem dataStyle="width:10%" 
                                               labelStyle="width:23%" 
                                               rendered="{!!c.meta.hasSecondary}"> 
                        <apex:outputText value="Total&nbsp;Patient&nbsp;Contribution" escape="false"/>
                        <apex:outputPanel styleClass="totalContri" >
                            <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Total_Patient_Contribution__c}" rendered="{!c.wrprObj.pyAgrmntWrksht.Total_Patient_Contribution__c!=null}" />
                            <apex:outputText value="$0.00" rendered="{!c.wrprObj.pyAgrmntWrksht.Total_Patient_Contribution__c==null}"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!c.meta.hasSecondary}" >
                        <apex:outputText value="Total&nbsp;EIV" escape="false"/>
                        <apex:outputPanel rendered="{!c.wrprObj.totalInsCoResp!=null}" styleClass="totalEIV">
                            <apex:outputText value="${0, number,0,000.00}" rendered="{!c.wrprObj.totalInsCoResp>=1000}" escape="false" style="white-space: nowrap;" >
                                <apex:param value="{!c.wrprObj.totalInsCoResp}" />
                            </apex:outputText>
                            <apex:outputText value="${0, number,0.00}" rendered="{!c.wrprObj.totalInsCoResp<1000}" escape="false" style="white-space: nowrap;">
                                <apex:param value="{!c.wrprObj.totalInsCoResp}" />
                            </apex:outputText>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <!-- Row 2 -->
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="Deductible&nbsp;Met" escape="false"/>
                        <apex:outputPanel >
                            <apex:outputField value="{!c.wrprObj.insrncBnft.Deductible_Met__c}" rendered="{!c.wrprObj.insrncBnft.Deductible_Met__c!=null}"/>
                            <apex:outputText value="$0.00" rendered="{!c.wrprObj.insrncBnft.Deductible_Met__c==null}"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="Out&nbsp;of&nbsp;Pocket&nbsp;Max&nbsp;Met" escape="false"/>
                        <apex:outputPanel >
                            <apex:outputField value="{!c.wrprObj.insrncBnft.Max_Out_of_Pocket_Met__c}" rendered="{!c.wrprObj.insrncBnft.Max_Out_of_Pocket_Met__c!=null}"/>
                            <apex:outputText value="$0.00" rendered="{!c.wrprObj.insrncBnft.Max_Out_of_Pocket_Met__c==null}"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="Co&nbsp;Insurance&nbsp;Amount&nbsp;Requested" escape="false"/>
                        <apex:inputField value="{!c.wrprObj.pyAgrmntWrksht.Co_Insurance_Amount_Requested__c}" style="width:120px;"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!!c.meta.hasSecondary}" >
                        <apex:outputText value="Total&nbsp;EIV" escape="false"/>
                        <apex:outputPanel rendered="{!c.wrprObj.totalInsCoResp!=null}" styleClass="totalEIV">
                            <apex:outputText value="${0, number,0,000.00}" rendered="{!c.wrprObj.totalInsCoResp>=1000}" escape="false" style="white-space: nowrap;" >
                                <apex:param value="{!c.wrprObj.totalInsCoResp}" />
                            </apex:outputText>
                            <apex:outputText value="${0, number,0.00}" rendered="{!c.wrprObj.totalInsCoResp<1000}" escape="false" style="white-space: nowrap;">
                                <apex:param value="{!c.wrprObj.totalInsCoResp}" />
                            </apex:outputText>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!c.meta.hasSecondary}" >
                        <apex:outputText value="Total&nbsp;Revenue" escape="false"/>
                        <apex:outputPanel styleClass="totalRevenue">
                            <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Total_Revenue__c}" rendered="{!c.wrprObj.pyAgrmntWrksht.Total_Revenue__c!=null}"/>
                            <apex:outputText value="$0.00" rendered="{!c.wrprObj.pyAgrmntWrksht.Total_Revenue__c==null}"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <!-- Row 3 -->
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="Deductible&nbsp;Remaining" escape="false"/>
                        <apex:outputPanel >
                            <apex:outputField value="{!c.wrprObj.insrncBnft.Deductible_Remaining__c}" rendered="{!c.wrprObj.insrncBnft.Deductible_Remaining__c!=null}"/>
                            <apex:outputText value="$0.00" rendered="{!c.wrprObj.insrncBnft.Deductible_Remaining__c==null}"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="Out&nbsp;of&nbsp;Pocket&nbsp;Max&nbsp;Remaining" escape="false"/>
                        <apex:outputPanel >
                            <apex:outputField value="{!c.wrprObj.insrncBnft.Max_Out_of_Pocket_Remaining__c}" rendered="{!c.wrprObj.insrncBnft.Max_Out_of_Pocket_Remaining__c!=null}"/>
                            <apex:outputText value="$0.00" rendered="{!c.wrprObj.insrncBnft.Max_Out_of_Pocket_Remaining__c==null}"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="Co-Pay&nbsp;Amount&nbsp;Requested" escape="false"/>
                        <apex:inputField value="{!c.wrprObj.pyAgrmntWrksht.Co_Pay_Amount_Requested__c}" style="width:120px;"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!!c.meta.hasSecondary}" >
                        <apex:outputText value="Total&nbsp;Revenue" escape="false"/>
                        <apex:outputPanel styleClass="totalRevenue">
                            <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Total_Revenue__c}" rendered="{!c.wrprObj.pyAgrmntWrksht.Total_Revenue__c!=null}" styleClass="totalContriVal"/>
                            <apex:outputText value="$0.00" rendered="{!c.wrprObj.pyAgrmntWrksht.Total_Revenue__c==null}"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!c.meta.hasSecondary}" >
                        <apex:outputText value="Total&nbsp;Co&nbsp;Pay" escape="false"/>
                        <apex:outputPanel styleClass="totalCopay" >
                            <apex:outputText value="${0, number,0,000.00}"
                                             rendered="{!c.wrprObj.totalCoPayAmt!=null && c.wrprObj.totalCoPayAmt>=1000}"
                                             style="white-space: nowrap;">
                                <apex:param value="{!c.wrprObj.totalCoPayAmt}" />
                            </apex:outputText>
                            <apex:outputText value="${0, number,0.00}"
                                             rendered="{!c.wrprObj.totalCoPayAmt !=null && c.wrprObj.totalCoPayAmt<1000}"
                                             style="white-space: nowrap;">
                                <apex:param value="{!c.wrprObj.totalCoPayAmt}" />
                            </apex:outputText>
                            <apex:outputText value="$ 0.00" rendered="{!c.wrprObj.totalCoPayAmt==null}"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <!-- Row 4 -->
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem rendered="{! AND(!c.isTalbott, !c.isIop)}">
                        <apex:outputText value="Room&nbsp;and&nbsp;Board&nbsp;Fee(s)" escape="false"/>
                        <apex:inputField value="{!c.wrprObj.pyAgrmntWrksht.Room_and_Board_Fees__c}" style="width:120px;"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!OR( c.isTalbott, c.isIop)}">
                        <apex:outputText value="Uncovered&nbsp;Charges" escape="false"/>
                        <apex:inputField value="{!c.wrprObj.pyAgrmntWrksht.Uncovered_Charges__c}" style="width:120px;"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!!c.meta.hasSecondary}">
                        <apex:outputText value="Daily&nbsp;Revenue" escape="false"/>
                            <apex:outputPanel style="{!IF(AND( c.wrprObj.targetEDR != null
                                               , c.wrprObj.pyAgrmntWrksht.Daily_Revenue__c!=null
                                               , c.wrprObj.pyAgrmntWrksht.Daily_Revenue__c != 0
                                               , c.wrprObj.pyAgrmntWrksht.Daily_Revenue__c < c.wrprObj.targetEDR),'color:red','color:black')}"
                                               styleClass="dailyRevenue target-edr" html-target-edr="{!c.wrprObj.targetEDR}" >
                            <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Daily_Revenue__c}" rendered="{!c.wrprObj.pyAgrmntWrksht.Daily_Revenue__c!=null}"  />
                            <apex:outputText value="$0.00" rendered="{!c.wrprObj.pyAgrmntWrksht.Daily_Revenue__c==null}"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!c.meta.hasSecondary}" >
                        <apex:outputPanel styleClass="totalContri" >
                            <apex:inputHidden value="{!c.wrprObj.pyAgrmntWrksht.Total_Patient_Contribution__c}" html-Class="totalContriVal"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <!-- Row 5 -->
                    <apex:pageBlockSectionItem dataStyle="text-align:right;margin-left: 34px !important;position: relative;left:15px;" >
                        <apex:outputText value="Plan&nbsp;Coverage" escape="false" styleClass="labelCol vfLabelColTextWrap"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{! OR( c.isTalbott, c.isIop)}">
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Plan_Coverage__c}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem labelStyle="text-align: left;" rendered="{! AND(!c.isTalbott, !c.isIop)}" >
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Plan_Coverage__c}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!AND(!c.isTalbott, !c.isIop)}">
                        <apex:outputText value="Ancillary Fee(s)"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Ancillary_Fees__c}" rendered="{!c.wrprObj.pyAgrmntWrksht.Ancillary_Fees__c!=null}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!AND(c.isTalbott, !c.isIop)}" >
                        <apex:outputText value="Days 60-90 Fee(s)"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Days_60_90_Fees__c}" rendered="{!c.wrprObj.pyAgrmntWrksht.Days_60_90_Fees__c!=null}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!AND(!c.isTalbott, c.isIop)}"/>
                    <apex:pageBlockSectionItem rendered="{!!c.meta.hasSecondary}">
                        <apex:outputText value="Total&nbsp;Co&nbsp;Pay" escape="false"/>
                        <apex:outputPanel styleClass="totalCopay" >
                            <apex:outputText value="${0, number,0,000.00}"
                                             rendered="{!c.wrprObj.totalCoPayAmt!=null && c.wrprObj.totalCoPayAmt>=1000}"
                                             style="white-space: nowrap;">
                                <apex:param value="{!c.wrprObj.totalCoPayAmt}" />
                            </apex:outputText>
                            <apex:outputText value="${0, number,0.00}"
                                             rendered="{!c.wrprObj.totalCoPayAmt !=null && c.wrprObj.totalCoPayAmt<1000}"
                                             style="white-space: nowrap;">
                                <apex:param value="{!c.wrprObj.totalCoPayAmt}" />
                            </apex:outputText>
                            <apex:outputText value="$ 0.00" rendered="{!c.wrprObj.totalCoPayAmt==null}"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!c.meta.hasSecondary}" >
                        <apex:outputPanel styleClass="dailyRevenue">
                            <apex:inputHidden value="{!c.wrprObj.pyAgrmntWrksht.Daily_Revenue__c}" 
                                              html-class="dailyRevenueVal" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <!-- Row 6 -->
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem rendered="{!AND(!c.isTalbott, !c.isIop)}">
                        <apex:outputText value="Miscellaneous Pay"/>
                        <apex:inputField value="{!c.wrprObj.pyAgrmntWrksht.Miscellaneous_Fees__c}" style="width:120px;"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!OR(c.isTalbott, c.isIop)}" />
                    <apex:pageBlockSectionItem />
                    <!-- Row 7 -->
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem >
                        <apex:outputText value="Private Pay"/>
                        <apex:inputField value="{!c.wrprObj.pyAgrmntWrksht.Private_Pay__c}" style="width:120px;"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem />
                    <!-- Row 8 -->
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem />
                </apex:pageBlockSection>

                <apex:pageBlockSection columns="4" id="patDel1" html-class="daysData">
                <!-- Row 1 -->
                    <apex:pageBlockSectionItem rendered="{!AND(!c.isTalbott, !c.isIop)}">
                        <apex:outputlabel value="Detox&nbsp;(DTX)" escape="false"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Num_Days_Detox_DTX__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem dataStyle="width:10%" labelStyle="width:23%" rendered="{!AND(!c.isTalbott, !c.isIop)}">
                        <apex:outputlabel value="Detox&nbsp;Pays&nbsp;at" escape="false"/>
                        <apex:outputPanel rendered="{!c.wrprObj.pyAgrmntWrksht.Detox_Pays_at__c!=null}">
                            <apex:outputText value="{0, number, 0,000.00}%" rendered="{!c.wrprObj.pyAgrmntWrksht.Detox_Pays_at__c>=1000}" style="white-space: nowrap;">
                                <apex:param value="{!c.wrprObj.pyAgrmntWrksht.Detox_Pays_at__c}" />
                            </apex:outputText>
                            <apex:outputText value="{0, number, 0.00}%" rendered="{!c.wrprObj.pyAgrmntWrksht.Detox_Pays_at__c<1000}" style="white-space: nowrap;">
                                <apex:param value="{!c.wrprObj.pyAgrmntWrksht.Detox_Pays_at__c}" />
                            </apex:outputText>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!AND(!c.isTalbott, !c.isIop)}">
                        <apex:outputlabel value="Detox&nbsp;Override" escape="false"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Detox_Over__c}" rendered="{!c.wrprObj.pyAgrmntWrksht.Detox_Over__c!=null}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!AND(!c.isTalbott, !c.isIop)}">
                    </apex:pageBlockSectionItem>
                    <!-- Row 2 -->
                    <apex:pageBlockSectionItem rendered="{!AND(!c.isTalbott, !c.isIop)}">
                        <apex:outputlabel value="Residential&nbsp;Treatment&nbsp;(RTC)" escape="false"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Num_Days_Residential_Treatment_RTC__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!AND(!c.isTalbott, !c.isIop)}">
                        <apex:outputlabel value="RTC&nbsp;Pays&nbsp;at" escape="false"/>
                        <apex:outputPanel rendered="{!c.wrprObj.pyAgrmntWrksht.RTC_Pays_at__c!=null}">
                            <apex:outputText value="{0, number, 0,000.00}%" rendered="{!c.wrprObj.pyAgrmntWrksht.RTC_Pays_at__c>=1000}" style="white-space: nowrap;">
                                <apex:param value="{!c.wrprObj.pyAgrmntWrksht.RTC_Pays_at__c}" />
                            </apex:outputText>
                            <apex:outputText value="{0, number, 0.00}%" rendered="{!c.wrprObj.pyAgrmntWrksht.RTC_Pays_at__c<1000}" style="white-space: nowrap;">
                                <apex:param value="{!c.wrprObj.pyAgrmntWrksht.RTC_Pays_at__c}" />
                            </apex:outputText>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!AND(!c.isTalbott, !c.isIop)}">
                        <apex:outputlabel value="Residential&nbsp;Treatment&nbsp;Override" escape="false"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Residential_Treatment_Override__c}" rendered="{!c.wrprObj.pyAgrmntWrksht.Residential_Treatment_Override__c!=null}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!AND(!c.isTalbott, !c.isIop)}">
                    </apex:pageBlockSectionItem>
                    <!-- Row 3 -->
                    <apex:pageBlockSectionItem >
                        <apex:outputlabel value="Partial&nbsp;Hospitalization&nbsp;(PHP)" escape="false"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Num_Days_Partial_Hospitalization_PHP__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputlabel value="PHP&nbsp;Pays&nbsp;at" escape="false"/>
                        <apex:outputPanel rendered="{!c.wrprObj.pyAgrmntWrksht.PHP_Pays_at__c!=null}">
                            <apex:outputText value="{0, number, 0,000.00}%" rendered="{!c.wrprObj.pyAgrmntWrksht.PHP_Pays_at__c>=1000}" style="white-space: nowrap;">
                                <apex:param value="{!c.wrprObj.pyAgrmntWrksht.PHP_Pays_at__c}" />
                            </apex:outputText>
                            <apex:outputText value="{0, number, 0.00}%" rendered="{!c.wrprObj.pyAgrmntWrksht.PHP_Pays_at__c<1000}" style="white-space: nowrap;">
                                <apex:param value="{!c.wrprObj.pyAgrmntWrksht.PHP_Pays_at__c}" />
                            </apex:outputText>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem dataStyle="width:10%" labelStyle="width:20%">
                        <apex:outputlabel value="Partial&nbsp;Hospitalization&nbsp;Override" escape="false"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Partial_Hospitalization_Override__c}"
                                          rendered="{!c.wrprObj.pyAgrmntWrksht.Partial_Hospitalization_Override__c!=null}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem />
                    <!-- Row 4 -->
                    <apex:pageBlockSectionItem >
                        <apex:outputlabel value="Intensive&nbsp;Outpatient&nbsp;(IOP)" escape="false"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Num_Days_Intensive_Outpatient_IOP__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputlabel value="IOP&nbsp;Pays&nbsp;at" escape="false"/>
                        <apex:outputPanel rendered="{!c.wrprObj.pyAgrmntWrksht.IOP_Pays_at__c!=null}">
                            <apex:outputText value="{0, number, 0,000.00}%" rendered="{!c.wrprObj.pyAgrmntWrksht.IOP_Pays_at__c>=1000}" style="white-space: nowrap;">
                                <apex:param value="{!c.wrprObj.pyAgrmntWrksht.IOP_Pays_at__c}" />
                            </apex:outputText>
                            <apex:outputText value="{0, number, 0.00}%" rendered="{!c.wrprObj.pyAgrmntWrksht.IOP_Pays_at__c<1000}" style="white-space: nowrap;">
                                <apex:param value="{!c.wrprObj.pyAgrmntWrksht.IOP_Pays_at__c}" />
                            </apex:outputText>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem dataStyle="width:10%" labelStyle="width:20%">
                        <apex:outputlabel value="Intensive&nbsp;Outpatient&nbsp;Override" escape="false"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Intensive_Outpatient_Override__c}"
                                          rendered="{!c.wrprObj.pyAgrmntWrksht.Intensive_Outpatient_Override__c!=null}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem />
                    <!-- Row 5 -->
                    <apex:pageBlockSectionItem html-Class="totalrowCountCls">
                        <apex:outputlabel value="Total" escape="false"/>
                        <apex:outputText value="{!c.wrprObj.totalRowCount}" style="{!if( c.wrprObj.totalRowCount<=30,'color:black;','color: red;')}" html-Class="totalRowCountValue"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem />
                    <!-- Row 6 -->
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem />
                    <apex:pageBlockSectionItem />
                    <!-- Row 7 -->
                    <apex:pageBlockSectionItem rendered="{!OR(c.isTalbott, c.isIop)}" html-class="uncoveredDayPnl">
                            <apex:outputlabel value="Uncovered&nbsp;Days" escape="false"/>
                            <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Num_Days_Uncovered__c}" 
                                              styleclass="uncoveredDaysCls"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{! OR(c.isTalbott, c.isIop)}">
                        <apex:outputlabel value="Uncovered&nbsp;Days&nbsp;Rate" escape="false"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Uncovered_Days_Rate__c}"
                                          rendered="{!c.wrprObj.pyAgrmntWrksht.Uncovered_Days_Rate__c!=null}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{! OR(c.isTalbott, c.isIop)}">
                        <apex:outputlabel value="Uncovered&nbsp;Days&nbsp;Override" escape="false"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Uncovered_Days_Override__c}"
                                          rendered="{!c.wrprObj.pyAgrmntWrksht.Uncovered_Days_Override__c!=null}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!OR(c.isTalbott, c.isIop)}">
                    </apex:pageBlockSectionItem>
                    <!-- Row 8 -->
                    <apex:pageBlockSectionItem rendered="{!AND(c.isTalbott, !c.isIop)}">
                        <apex:outputlabel value="Room&nbsp;and&nbsp;Board&nbsp;Days" escape="false"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Num_Days_Room__c}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!AND(c.isTalbott, !c.isIop)}">
                        <apex:outputlabel value="Room&nbsp;and&nbsp;Board&nbsp;Days&nbsp;Rate" escape="false"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Room_and_Board_Days_Rate__c}" rendered="{!c.wrprObj.pyAgrmntWrksht.Room_and_Board_Days_Rate__c!=null}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!AND(c.isTalbott, !c.isIop)}">
                        <apex:outputlabel value="Room&nbsp;and&nbsp;Board&nbsp;Days&nbsp;Override" escape="false"/>
                        <apex:outputField value="{!c.wrprObj.pyAgrmntWrksht.Room_and_Board_Days_Override__c}"
                                          rendered="{!c.wrprObj.pyAgrmntWrksht.Room_and_Board_Days_Override__c!=null}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!AND(c.isTalbott, !c.isIop)}">
                    </apex:pageBlockSectionItem>
                    <!-- Row 9-->
                    <apex:pageBlockSectionItem rendered="{!OR(c.isTalbott, c.isIop)}">
                        <apex:outputlabel value="Total" escape="false"/>
                        <apex:outputText value="{!c.wrprObj.totalTalbottDay}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!OR(c.isTalbott, c.isIop)}">
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!OR(c.isTalbott, c.isIop)}">
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!OR(c.isTalbott, c.isIop)}">
                    </apex:pageBlockSectionItem>
               </apex:pageBlockSection>

                <div class="accordion">
                    <h3><a href="#">PAW Details</a></h3>
                    <div>
                        <apex:outputPanel id="WorksheetDetail" styleClass="WorksheetDetail" html-paw-record-id="{!c.pawRecordId}">
                            <apex:outputPanel rendered="{!c.wrprObj.pawDetailListDisplayFlag}" >
                                <style>
                                    .tbl tr th, .tbl tr td{padding:3px 3px;text-align:center;vertical-align:middle;}
                                    .tbl tr th{font-weight:bold}
                                </style>
                                <table border="1" cellspacing="0" cellpadding="0" class="tbl" style="margin-top:2%;">
                                    <tr>
                                        <th>Days </th>
                                        <th>LOC </th>
                                        <th>Billed Rate </th>
                                        <th>Ins Coverage </th>
                                        <th>(Effective)<br/>Beginning<br/>Deductible </th>
                                        <th>Apply<br/>Deductible </th>
                                        <th>Charge After<br/>Deductible </th>
                                        <th>Beginning OOP </th>
                                        <th>OOP After<br/>Deductible </th>
                                        <th>Calculated Co-<br/>Ins </th>
                                        <th>Co-Ins </th>
                                        <th>Ins EIV </th>
                                        <th>Patient<br/>Responsibility </th>
                                        <th>Ins Co Responsibility </th>
                                    </tr>
                                    <apex:variable value="{!1}" var="rowNum"/>
                                    <apex:repeat value="{!c.wrprObj.relatedPAWDetailsList}" var="detailInstance">
                                        <tr>
                                           <td><apex:outputText value="{! FLOOR(rowNum)}"/>  </td>
                                           <td><apex:outputText value="{!detailInstance.Level_of_Care__c}"/> </td>
                                           <td><apex:outputField value="{!detailInstance.Billed_Rate__c}"/> </td>
                                           <td><apex:outputText value="{!detailInstance.Insurance_Coverage__c}%"/> </td>
                                           <td><apex:outputField value="{!detailInstance.Beginning_Deductible__c}"/> </td>
                                           <td><apex:outputField value="{!detailInstance.Applied_Deductible__c}"/> </td>
                                           <td><apex:outputField value="{!detailInstance.Charge_After_Deductible__c}"/> </td>
                                           <td><apex:outputField value="{!detailInstance.Beginning_Out_of_Pocket__c}"/> </td>
                                           <td><apex:outputField value="{!detailInstance.Out_of_Pocket_After_Deductible__c}"/> </td>
                                           <td><apex:outputField value="{!detailInstance.Calculated_Co_Insurance__c}"/> </td>
                                           <td><apex:outputField value="{!detailInstance.Co_Insurance__c}"/> </td>
                                           <td><apex:outputField value="{!detailInstance.Insurance_EIV__c}"/> </td>
                                           <td><apex:outputField value="{!detailInstance.Patient_Responsibility__c}"/> </td>
                                           <td><apex:outputField value="{!detailInstance.Insurance_Co_Responsibility__c}"/> </td>
                                        </tr>
                                        <apex:variable var="rowNum" value="{! rowNum + 1}"/>
                                    </apex:repeat>
                                </table>
                            </apex:outputPanel>
                        </apex:outputPanel>
                    </div>
                </div>
            </apex:pageBlock>
        </apex:form>
    </div>

    <script>
        var frn = frn || {};

        $(document).ready(function(event) {
            frn.collapseAccordian();

            $(document).on( "updateEvent", function() {
                frn.showLoader();
                call('{!c.year}','eventListnerAction');
            });
        });

        var call =  function(year,functionName,arguments){
            return window["paw"+year][functionName](arguments);
        };
        var updateEvent = function() {
            // method call to check if insurance, benefit, program, rate are not blank
            var validatePatientInsuranceResult = frn.validatePatientInsurances();
            var validateInsuranceBenefitResult = frn.validateInsuranceBenefits();
            var validateFacilityProgramResult = frn.validateFacilityPrograms();
            var validateRateAdjustmentResult = frn.validateRateAdjustments();

            console.log('>>> 1 validatePatientInsuranceResult : ',validatePatientInsuranceResult);
            console.log('>>> 2 validateInsuranceBenefitResult : ',validateInsuranceBenefitResult);
            console.log('>>> 3 validateFacilityProgramResult : ',validateFacilityProgramResult);
            console.log('>>> 4 validateRateAdjustmentResult : ',validateRateAdjustmentResult);

            if(false == validatePatientInsuranceResult
            || false == validateInsuranceBenefitResult
            || false == validateFacilityProgramResult
            || false == validateRateAdjustmentResult) {
                console.log('>>> 6 ');
                frn.hideLoader();
                return false;
            } else {
                console.log('>>> 5');
                $(document).trigger( "updateEvent" );

            }
            
        };

        frn.collapseAccordian = function(){

            $( ".accordion").each( function(index,accordianWrapElem){

                if( $(accordianWrapElem).find("tr").length < 1 ){

                    $(accordianWrapElem).hide();

                    return true;
                } else {
                    $(accordianWrapElem).show();
                }

                if( $(accordianWrapElem).hasClass("ui-accordion") ){
                    $(accordianWrapElem).accordion("destroy");
                }

                $( accordianWrapElem ).accordion({
                      collapsible: true
                    , active: false
                });
            });
        };

        frn.loadAccordian = function() {
            frn.collapseAccordian();
            frn.pageReloadComplete();
        };

        frn.onSaveDetails = function(validVar) {

            frn.showLoader();

            var validateFRNResult = frn.validateFRNFacilities();

            if( false == validateFRNResult ){
                frn.hideLoader();
                return false;
            }

            if ( frn.isTargetEDRAchieved() == false ) {

                if (!confirm("The EDR is less that the target EDR for the selected facility. Are you sure you want to continue?")) {
                    frn.hideLoader();
                    return false;
                }
            }

            $(document).trigger( "saveEvent");
                frn.saveCalling(false, '{!c.meta.primaryYear}');
        };

    </script>
</apex:component>