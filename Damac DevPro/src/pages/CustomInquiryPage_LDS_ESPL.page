<apex:page standardcontroller="Inquiry__c" extensions="CustomInquiryPageController_LDS" sidebar="false" showHeader="false" docType="html-5.0">
 <apex:slds />
    <!-- Lightning Design System Source -->
    <apex:stylesheet value="{!URLFOR($Resource.Lightning, 'assets/styles/salesforce-lightning-design-system-vf.css')}" />
    <!-- jQuery CDN -->
    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
    <!-- MomentJS CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.12.0/moment.js"></script>
    <!-- Important To Include ALJS init File-->
    <script src="{!URLFOR($Resource.appiphonyLightningJss, '/jquery.aljs-init.min.js')}"></script>
    <!-- ALJS Datepicker Module-->
    <script src="{!URLFOR($Resource.appiphonyLightningJss, '/jquery.aljs-datepicker.min.js')}"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="/soap/ajax/38.0/connection.js"></script>
<!-- <script src="/soap/ajax/38.0/apex.js"/> -->
<style>
    .lookupInput  a,.lookupInput a{
        border: none !important;
        background: none !important;
    }
    .lookupInput img {
        vertical-align: middle;
        margin-right: .25em;
        background-repeat: no-repeat;
    }
    .lookupIcon {
        background-image: url(/img/func_icons/util/search16.png);
        background-position: 0 0;
        width: 20px;
        height: 20px;
        background-position: top left;
        margin-left: -30px !important;
    }
    .lookupIconOn {
        background-image: url(/img/func_icons/util/search16.png);
        background-position: 0 0;
        width: 20px;
        height: 20px;
        background-position: top left;
        margin-left: -30px !important;
    }
    .paddingDatePicker>.pbSubsection {
        padding-left:0px !important;
        padding-right:0px !important;
    }
</style>
<script type="text/javascript">
    /*
    init();
    function init(){
        populateMobile(getParameterByName('epn')); 
    }
    function getParameterByName(name) {
        name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
            results = regex.exec(location.search);
        return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }
    var j$ = jQuery.noConflict();
    sforce.connection.sessionId= '{!$Api.Session_ID}';
    j$(document).ready(function(){
        var epn = getParameterByName('epn');
        var pext = getParameterByName('pext__c');
        
        if(pext != '' && pext != null)
            j$('.userextNo').val(pext);//[id$=ADRESTextBox]
        if(epn != '' && epn != null){
            j$('.mobilePhone').val(epn);//[id$=ADRESTextBox]
            var objectDefinition = sforce.connection.describeSObject("Inquiry__c");
            splitandPooulateCountryCode(objectDefinition.fields,'Mobile_CountryCode__c',epn);
        }
        
    });

    function getParameterByName(name) {
        name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
            results = regex.exec(location.search);
        return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }

    //Method takes the all fileds and matching field
    function splitandPooulateCountryCode(objectFields,countrycodeField,mobile){
        j$.each( objectFields, function( i, fieldName ) {
            var flag = false;
            console.log('mobile '+mobile);
            //picklist field name is matched
            if(fieldName.name == countrycodeField)
                j$.each( fieldName.picklistValues, function( i, conuntryCodeVal ) { // field.picklistValues to get the picklist values of field
                    var countryCodePicklist = conuntryCodeVal.value;
                    var countryCode = countryCodePicklist.split(': ');//split the picklist value
                    console.log('countryCodePicklist '+countryCodePicklist);
                    console.log('countryCode '+countryCode);
                    if(countryCode.length == 2 && mobile.startsWith(countryCode[1])){//if the list is having size 2
                        console.log('conuntryCodeVal 1 = '+conuntryCodeVal);
                        j$('.countryCode').val(countryCodePicklist);//assign country code to mobile
                        flag = true;
                        return false;//break inner for loop
                    }
                });
            //break outer for loop
            if(flag)
                return false;
        });
    }*/
    function formatLookup() {
        $('a[class$=slds-input]').removeClass('slds-input');
    } 
</script>
<apex:messages />
    <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"/>
    <apex:sectionheader html-class="slds-page-header" title="{!$ObjectType.Inquiry__c.label} Edit" subtitle="{!IF(ISNULL(Inquiry__c.Name), 'New Inquiry',Inquiry__c.Name)}"/>
    <apex:form styleClass="slds-form" id="myform">
        <!-- <apex:actionFunction name="populateMobile" action="{!populateMobile}" reRender="myform" status="myStatus">
            <apex:param name="encryptedMobile" value="" assignTo="{!encryptedMobile}"/>   
        </apex:actionFunction> -->
        <apex:actionStatus id="myStatus">
            <apex:facet name="start">
                <div class="waitingSearchDiv" id="el_loading" style="background-color: #000000; height: 100%;opacity:0.65;width:100%; z-index: 102; zIndex: 102;"> 
                    <div class="waitingHolder" style="width: 150px; border: 1px solid grey; padding: 10px; border-radius: 5px; background-color: #fbfbfb">
                        <img class="waitingImage" src="/img/loading.gif" title="Please Wait..." />
                        <span class="waitingDescription">Please Wait...</span>
                    </div>
                </div>
            </apex:facet>
        </apex:actionStatus>
        <apex:pageblock html-class="slds-panel" mode="edit" title="{!$ObjectType.Inquiry__c.label} Edit">
            <apex:pageblockbuttons styleClass="slds-button" >
                
                <apex:commandbutton styleClass="slds-button slds-button--neutral" value="Save" action="{!SaveInquiry}" status="myStatus" reRender="myform,msgBlock" rendered="{!!hideSavebtn}"/>
                
                <!--<apex:commandbutton styleClass="slds-button slds-button--neutral" value="Cancel" action="{!Cancel}"/>-->
            </apex:pageblockbuttons>
            <apex:pageMessages id="msgBlock"/>
           
            <!-- {!encryptedMobile} -->
            <!-- **********   [Record Type : Inquiry ]   **********  -->
            
                <apex:pageblocksection html-class="slds-panel__section" title="Information" showheader="true" columns="2">
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Title__c}" required="false"/>
                    <apex:outputfield value="{!inquiry.Assigned_Date__c}" />
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.First_Name__c}" required="true"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Title_Arabic__c}"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Last_Name__c}" required="true"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.First_Name_Arabic__c}" />
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Nationality__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Last_Name_Arabic__c}" />
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Preferred_Language__c}" required="true"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Nationality_Arabic__c}" />
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Passport_Number__c}" required="false"/>
<!--                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Date_of_Birth__c}" required="false"/>-->
                    <apex:pageBlockSection columns="2" html-class="paddingDatePicker">
                        <div style="margin-right: calc(0.8125em + (1px * 2));">
                        <label class="slds-form-element__label labelCol vfLabelColTextWrap" style="float:right;right: 0px;width: 100%;" for="date-01">Date of Birthday</label>
                            <div xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                <div id="date-01" class="slds-form-element"> 
                                    <div class="slds-form-element__control" style="width:100%;">
                                        <div class="slds-input-has-icon slds-input-has-icon--right">
                                            <svg aria-hidden="true" class="slds-input__icon slds-icon-text-default">
                                                <use xlink:href="{!URLFOR($Resource.Lightning, '/assets/icons/utility-sprite/svg/symbols.svg#event')}"></use>
                                            </svg> 
                                            <input id="date-Date_of_Birth__c" Class="slds-input date" type="text" placeholder="Pick a Date"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </apex:pageBlockSection>

                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Passport_Place_of_Issue__c}" required="false"/>
                    <!--<apex:inputfield styleClass="slds-input" value="{!inquiry.Passport_Expiry_Date__c}" required="false"/>-->
                    <apex:pageBlockSection columns="2" html-class="paddingDatePicker">
                        <div style="margin-right: calc(0.8125em + (1px * 2));">
                        <label class="slds-form-element__label labelCol vfLabelColTextWrap" style="float:right;right: 0px;width: 100%;" for="date-02">Passport Expiry Date</label>
                            <div xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                <div id="date-02" class="slds-form-element"> 
                                    <div class="slds-form-element__control" style="width:100%;">
                                        <div class="slds-input-has-icon slds-input-has-icon--right">
                                            <svg aria-hidden="true" class="slds-input__icon slds-icon-text-default">
                                                <use xlink:href="{!URLFOR($Resource.Lightning, '/assets/icons/utility-sprite/svg/symbols.svg#event')}"></use>
                                            </svg> 
                                            <input id="date-Passport_Expiry_Date__c" Class="slds-input date" type="text" placeholder="Pick a Date"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </apex:pageBlockSection>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Company__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Passport_Place_of_Issue_Arabic__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.All_Activities_Counter__c}"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Job_Title__c}" required="false"/>
                </apex:pageblocksection>
                <apex:pageblocksection html-class="slds-panel__section" title="Organization Details" showheader="true" columns="2">    
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Organisation_Name__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Organisation_Name_Arabic__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.CR_Number__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.CR_Registration_Place__c}" required="false"/>
                    <!--<apex:inputfield styleClass="slds-input" value="{!inquiry.CR_Registration_Expiry_Date__c}" required="false"/>-->
                    <apex:pageBlockSection columns="2" html-class="paddingDatePicker">
                        <div style="margin-right: calc(0.8125em + (1px * 2));">
                        <label class="slds-form-element__label labelCol vfLabelColTextWrap" style="float:right;right: 0px;width: 100%;" for="date-03">CR Registration Expiry Date</label>
                            <div xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                <div id="date-03" class="slds-form-element"> 
                                    <div class="slds-form-element__control" style="width:100%;">
                                        <div class="slds-input-has-icon slds-input-has-icon--right">
                                            <svg aria-hidden="true" class="slds-input__icon slds-icon-text-default">
                                                <use xlink:href="{!URLFOR($Resource.Lightning, '/assets/icons/utility-sprite/svg/symbols.svg#event')}"></use>
                                            </svg> 
                                            <input id="date-CR_Registration_Expiry_Date__c" Class="slds-input date" type="text" placeholder="Pick a Date"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </apex:pageBlockSection>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.CR_Registration_Place_Arabic__c}" required="false"/>
                </apex:pageblocksection>
                <apex:pageblocksection html-class="slds-panel__section" title="Inquiry Status" showheader="true" columns="2">
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Inquiry_Source__c}" />
                    <apex:outputfield value="{!inquiry.Inquiry_Channel__c}" />
                    <apex:outputfield value="{!inquiry.Inquiry_Score__c}" />
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Campaign__c}" />
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Comments__c}" />
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Inquiry_Status__c}" />
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Property__c}" />
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Inquiry_Sub_Status__c}" />
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Type_of_Property_Interested_in__c}" />
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Budget__c}" />
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Project__c}" />
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.No_of_Bedrooms__c}" />
                </apex:pageblocksection>
                <apex:pageblocksection html-class="slds-panel__section" title="Contact Details" showheader="true" columns="2"> 
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Mobile_CountryCode__c}" required="true"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Mobile_Phone_Encrypt__c}" required="true"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Mobile_Country_Code_2__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Mobile_Phone_Encrypt_2__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Mobile_Country_Code_3__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Mobile_Phone_Encrypt_3__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Mobile_Country_Code_4__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Mobile_Phone_Encrypt_4__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Mobile_Country_Code_5__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Mobile_Phone_Encrypt_5__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Email__c}" required="true"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Email_2__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Email_4__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Email_3__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Email_5__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Primary_Contacts__c}" required="true"/>
                </apex:pageblocksection> 
                <apex:pageblocksection html-class="slds-panel__section" title="Agent Information" showheader="true" columns="2"> 
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Agency_Name__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Agent_Email__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Agent_Name__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Agent_Phone__c}" required="false"/>
                </apex:pageblocksection>
                <apex:pageblocksection html-class="slds-panel__section" title="Address Details" showheader="true" columns="2">
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Address_Line_1__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Address_Line_1_Arabic__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Address_Line_2__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Address_Line_2_Arabic__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Address_Line_3__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Address_Line_3_Arabic__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Address_Line_4__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Address_Line_4_Arabic__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Country__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.Country_Arabic__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.City_new__c}" required="false"/>
                    <apex:inputfield styleClass="slds-input" value="{!inquiry.City_Arabic__c}" required="false"/>
                </apex:pageblocksection>
                <script>formatLookup();</script>
        </apex:pageblock>
        <apex:actionfunction name="populateDates" action="{!populateDates}" rerender="blankID">
            <apex:param name="id" value=""/>
            <apex:param name="date" value=""/>
        </apex:actionfunction>
    </apex:form>
    <!--<center><br/>
        <i style="font-size:10px;color:#aaa;">Generated By LAYOUT PAGE <a href="http://www.clerisoft.com" target="_blank">[http://www.clerisoft.com]</a> (2008-2014) : Sat Mar 11 2017 02:56:36 GMT+0400 (Arabian Standard Time)</i>
    </center><br/>-->
    <script>
var j$ = jQuery.noConflict();
//Assigning SLDS Static Resource Path To A Variable To Use It With ALJS Initialization
var assetsLoc = '{!URLFOR($Resource.Lightning)}';
  
//ALJS Initialization   
       
$.aljsInit({
  assetsLocation: assetsLoc, //SLDS Static Resource Path
  scoped: true
});
   
j$(document).ready(function() {
//Initializing Datepicker with options To The SLDS Input on document ready.
 $('.date').datepicker({
    
    format: 'MM/DD/YYYY', //Date Format Of Datepicker Input Field
    onChange: function(datepicker) {
    var selObj = datepicker.$selectedInput;
    if(selObj){
        var id = selObj.get('0').id;
        var date = selObj.get('0').value;
        populateDates(id,date);
    }
    //methodOneInJavascript(document.getElementById("date-01").value);
   }
  });
  $('#date-Date_of_Birth__c').val('{!inquiry.Date_of_Birth__c}');
  $('#date-CR_Registration_Expiry_Date__c').val('{!inquiry.CR_Registration_Expiry_Date__c}');
  $('#date-Passport_Expiry_Date__c').val('{!inquiry.Passport_Expiry_Date__c}');
});

</script>
</apex:page>