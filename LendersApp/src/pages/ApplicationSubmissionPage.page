<apex:page controller="ApplicationSubmissionController">

    <!-- JQuery --> 
    <apex:includeScript value="{!URLFOR($Resource.bootstrap, 'js/jquery.min.js')}" />
    
    
    <!-- Bootstrap -->
    <apex:includeScript value="{!URLFOR($Resource.bootstrap, 'js/bootstrap.min.js')}" />
    <link href="{!URLFOR($Resource.bootstrap, 'css/btforce.css')}" rel="stylesheet"></link>

    
    <!-- Plugins -->
    <apex:includeScript value="{!URLFOR($Resource.bootstrap, 'js/jasny-bootstrap.min.js')}" />
    <link href="{!URLFOR($Resource.bootstrap, 'css/jasny-bootstrap.min.css')}" rel="stylesheet"></link>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet"></link>
    <apex:includeScript value="{!URLFOR($Resource.applicationportal, 'js/jquery.maskedinput.js')}" />
    
    <title>Funding Application</title>

    <style>
        @import url(//fonts.googleapis.com/css?family=Merriweather+Sans);

        * { margin: 0; padding: 0; }
            
        html, body {min-height: 100%; font-family: Arial !important;}
            
        .breadcrumbContainer {
            text-align: center;
            margin-top: 5px;
        }
            
        .breadcrumb {
            /*centering*/
            display: inline-block;
            overflow: hidden;
            border-radius: 5px;
            /*Lets add the numbers for each link using CSS counters. flag is the name of the counter. to be defined using counter-reset in the parent element of the links*/
            counter-reset: flag; 
        }
        
        .breadcrumb a {
            text-decoration: none;
            outline: none;
            display: block;
            float: left;
            font-size: 12px;
            line-height: 36px;
            color: white;
            /*need more margin on the left of links to accomodate the numbers*/
            padding: 0 10px 0 60px;
            background: #666;
            background: linear-gradient(#666, #333);
            position: relative;
        }
        
        /*since the first link does not have a triangle before it we can reduce the left padding to make it look consistent with other links*/
        .breadcrumb a:first-child {
            padding-left: 46px;
            border-radius: 5px 0 0 5px; /*to match with the parent's radius*/
        }

        .breadcrumb a:first-child:before {
            left: 14px;
        }

        .breadcrumb a:last-child {
            border-radius: 0 5px 5px 0; /*this was to prevent glitches on hover*/
            padding-right: 20px;
        }
        
        a:hover {
          text-decoration: none!important;
          color:#333!important;
        }
        
        /*hover/active styles*/
        .breadcrumb a.active, .breadcrumb a:hover{
            background: #333;
            background: linear-gradient(#333, #000);
        }

        .breadcrumb a.active:after, .breadcrumb a:hover:after {
            background: #333;
            background: linear-gradient(135deg, #333, #000);
        }
        
        /*adding the arrows for the breadcrumbs using rotated pseudo elements*/
        .breadcrumb a:after {
            content: '';
            position: absolute;
            top: 0; 
            right: -18px;
            width: 36px; 
            height: 36px;
            transform: scale(0.707) rotate(45deg);
            -webkit-transform: scale(0.707) rotate(45deg);
            z-index: 1;
            /*background same as links but the gradient will be rotated to compensate with the transform applied*/
            background: #666;
            background: linear-gradient(135deg, #666, #333);
            /*stylish arrow design using box shadow*/
            box-shadow: 
                2px -2px 0 2px rgba(0, 0, 0, 0.4), 
                3px -3px 0 2px rgba(255, 255, 255, 0.1);
            border-radius: 0 5px 0 50px;
        }

        /*we dont need an arrow after the last link*/
        .breadcrumb a:last-child:after {
            content: none;
        }

        /*we will use the :before element to show numbers*/
        .breadcrumb a:before {
            content: counter(flag);
            counter-increment: flag;
            /*some styles now*/
            border-radius: 100%;
            width: 20px;
            height: 20px;
            line-height: 20px;
            margin: 8px 0;
            position: absolute;
            top: 0;
            left: 30px;
            background: #444;
            background: linear-gradient(#444, #222);
            font-weight: bold;
        }
        
        
        .flat a, .flat a:after {
            background: white;
            color: black;
            transition: all 0.5s;
        }

        .flat a:before {
            background: white;
            box-shadow: 0 0 0 1px #ccc;
        }

        .flat a:hover, .flat a.active, 
        .flat a:hover:after, .flat a.active:after{
            background: #DDD;
        }
        
        body {
            font-size: 13px !important;
        }

        .noSidebarCell {
            padding: 5px;
        }

        .navmenu {
            border-radius: 0; 
            width: 100%;
            border: none;
        }

        .navmenu-nav li {
            margin: 0;
        }

        .navmenu li:first-child a {
            border-top: 1px solid #dce4e7 !important;
        }

        .last-item {
            border-bottom: 1px solid #dce4e7 !important;
        }

        .navmenu-nav li a {
            margin: 0 !important;
            margin-bottom: 0px !important;
            margin-left: 0px !important;
            padding: 2px !important;
            background: #f2f5f6;
            font-weight: normal !important;
            border: 1px solid #dce4e7 !important;
            border-top-color: #fff !important;
            color: #222 !important;
            line-height: 30px !important;
            font-size: 13px !important;
            padding-left: 10px !important;

        }       

        .nav .open>a, .nav .open>a:hover, .nav .open>a:focus {
            border: 1px solid #dce4e7;
        }

        .navmenu-nav li.subitem a {
            background: #eaeef0;
            border-bottom: 0 !important;
            border-top: 0 !important;
            padding-left: 25px !important;
        }       

        ul li a:hover {
            background: gray !important;
            color: white !important;
        }       

        .dropdown-menu {
            padding: 0 !important;
            margin: 0 !important;
        }

        .navmenu-nav li a .caret {
            display: inline-block;
            float: right;
            margin-top: 14px;
            margin-right: 8px;
            color: #222 !important;
            border-top-color: #222 !important;
            border-bottom-color: #222 !important;           
        }

        .navmenu-nav {
            margin: 0;
        }

        .section {
            display: none;
        }   

        .expand .caret {
            border-top: none;
            border-bottom: 4px solid #222;
        }   

        .pageTitle {
            /*padding: 15px 0px;
            margin-bottom: 30px;        
            border-bottom: 2px solid #57B1D1;   
            text-align: center;
            margin-top: 5px;*/

            padding: 8px 0px;
            margin-bottom: 30px;
            border-bottom: 2px solid #57B1D1;
            text-align: center;
            margin-top: 5px;            
        }

        .pageTitle h2 {
            margin: 0;
            font-size: 20px;
        }

        div.formRow {
            border-bottom: 1px solid #EEE;
            padding: 5px 0px;
        }

        div.formLabel {
            font-weight: bold;
            text-align: right;
        }

        .help-message {
            margin-bottom: 20px;
        }

        .tooltip {
            width: 100%;
        }
        
        .btn-sm {
            margin-left:5px!important;
        }
        
        .box {
            float: left;
            width: 200px;
            height: 100px;
            margin: 1em;
        }

        .after-box {
          clear: left;
        }
        
        .btn-file {
            position: relative;
            overflow: hidden;
        }

        .btn-file input[type=file] {
            position: absolute;
            top: 0;
            right: 0;
            min-width: 100%;
            min-height: 100%;
            font-size: 100px;
            text-align: right;
            filter: alpha(opacity=0);
            opacity: 0;
            outline: none;
            background: white;
            cursor: inherit;
            display: block;
        }
        
        .hidden {
           display: none;
        }

        .bootstrap .panel-body {
            padding: 10px 15px;
        }      

        .bootstrap label {
            display: inherit;
        }  

        .error {
            border: 1px solid red;
        }

        input[type=text],input[type=password],
        textarea {
            width: 80%;
            height: 33px;
            padding: 0 5px;
            font-size: 14px;
            font-family: Arial;            
        }

        .row {
            padding-bottom: 20px;
        }

        a:hover {
            color: #57B1D1;
        }

        .breadcrumb a {
            border: 1px solid #CCC;
        }    

        #loader {
            width: 100%;
            height: 100%;
            position: fixed;
            left: 0;
            top: 0;
            background: #fff url('{!URLFOR($Resource.applicationportal, "img/loader.gif")}') no-repeat scroll center center;
            z-index: 1000;
            opacity: 0.6;            
        }

        .subtitlesection {
            border-top: 1px solid #dddddd; 
            border-bottom: 1px solid #dddddd;
        }

        .subtitlesection  h4 {
            margin: 0;
            color: #999;   
        }    

        .submitted {
            text-align: center;
        }
        .zindex {    
            z-index: 16777271 !important;  
        }

        .bootstrap select[size] {
            height: 34px;
        }

    </style>
    
    <apex:form >
        <apex:actionFunction name="changeStageByApplicationNumber" action="{!queryApplicationByApplicationNumber}" />
        <apex:inputText value="{!email}" styleClass="applicationEmail" style="display: none;" />
        <apex:inputText value="{!applicationNumber}" styleClass="applicationNumber" style="display: none;" />
        
        <script>
        
            function searchApplication() {

                $(".applicationEmail").val($("#applicationEmail").val());
                $(".applicationNumber").val($("#applicationNumber").val());
                changeStageByApplicationNumber();
            }

        </script>

    </apex:form>
    
    <apex:form style="width:85%; margin-left: auto; margin-right: auto; margin-top: 20px;" enctype="multipart/form-data">
        
        <!-- <div id="header" style="margin-top: 20px;padding-bottom: 35px;margin-bottom: 20px;border-bottom: 2px solid #57B1D1; height: 70px;">
            <img src="{!settings.Public_Site_URL__c}/servlet/servlet.ImageServer?id={!logoId}{!"&"}oid={!$Organization.Id}" />

            <div style="float: right; margin-top: 40px;">
                <a href="#myModal" style="color: #57B1D1;font-family: Arial;font-size: 14px;" role="button" data-toggle="modal">Resume Your Application</a>
            </div>
        </div> -->

        <apex:outputPanel id="container" styleClass="container">
            
            <apex:actionFunction name="changeStageFunction" action="{!changeStage}" rerender="container" oncomplete="hideLoader();" />
            <apex:actionFunction name="changeStageFunctionNR" action="{!changeStage}" />
            <apex:inputText value="{!stage}" styleClass="stage" style="display: none;" />
            <apex:actionFunction name="save" action="{!save}" />
            <apex:actionFunction name="submitApplication" action="{!submitApplication}" />
            
            
            <script>
                $(function() {

                    $(".phone").mask("(999) 999-9999");
                });

                function changeStage(stage) {

                    $(".stage").val(stage);

                    if ('{!stage}' == 'stage3') {

                        changeStageFunctionNR();
                        showLoader();
                    }
                    else {

                        changeStageFunction();
                        showLoader();
                    }
                }


                function showLoader() {

                    $("#loader").show();
                }


                function hideLoader() {

                    $("#loader").hide();
                }

            </script>        
    
            <apex:outputPanel rendered="{!NOT(stage == 'stage5')}">        
                <div class="breadcrumbContainer" >
                    <div class="breadcrumb flat">
                        &nbsp;&nbsp;
                            <a href="javascript:;" class="fist active" onclick="changeStage('stage1'); save();">Business Information</a>
                        &nbsp;&nbsp;
                            <a href="javascript:;" class="second {!IF(stage == 'stage2' || stage == 'stage3' || stage == 'stage4', 'active', '')}" 
                                    onclick="changeStage('stage2');">Personal Information</a>
                        &nbsp;&nbsp;
                            <a href="javascript:;" class="third  {!IF(stage == 'stage3' || stage == 'stage4', 'active', '')}" onclick="changeStage('stage3');">Upload Attachments</a>
                        &nbsp;&nbsp;<a href="javascript:;" class="fourth {!IF(stage == 'stage4', 'active', '')}" onclick="changeStage('stage4');">Submit!</a>
                    </div>
                </div>

                <div class="pageTitle"></div>
            </apex:outputPanel>
            
            <div class="errorMessage" style="color:red;" >
                <p>{!error}</p>
            </div>

            <div class="bootstrap">
             
                <div id="myModal" class="modal fade">
                    <div class="modal-dialog zindex">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                                <h4 class="modal-title">Resume Application</h4>
                            </div>
                            <div class="modal-body">
                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Email:</label>
                                            <input id="applicationEmail" type="text" style="width: 80%;" />  
                                        </div>
                                     </div>               
                                </div>
                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Application Number:</label>
                                            <input id="applicationNumber" type="text" style="width: 80%;" />
                                        </div>
                                    </div>               
                                </div>
                            </div>
                            
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary btn-sm" onclick="searchApplication()" >Resume</button>
                            </div>
                        </div><!-- /.modal-content -->
                    </div><!-- /.modal-dialog -->
                </div><!-- /.modal -->

                <div id="loader" style="display: none;"></div>

                <apex:outputPanel styleClass="stage1" style="display:{!IF(stage != 'stage1', 'none', '')};">
                    <div class="panel panel-default">
                        
                        <!-- STEP 1 SECTION -->                     
                        <div class="panel-heading" style="text-align: center;">
                            <i class="fa fa-question-circle fa-2x tooltip-icon" title="{!settings.Business_Information_Help_Text__c}" style="float:left;margin-top:1px"/>
                            <input class="btn btn-primary btn-sm" type="button" value="Continue" onclick="changeStage('stage2'); save();" />
                            <input class="btn btn-default btn-sm" type="button" value="Save For Later" onclick="save();" style="float: right;padding-bottom: 8px;padding-top: 8px;" />
                        </div>
                                    
                        <div class="row">
                            <!-- LEFT COLUMN -->
                            <div class="col-md-6">
                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Business Name:</label>
                                            <apex:inputField value="{!app.Business_Name__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>First Name:</label>
                                            <apex:inputField value="{!app.First_Name__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>           

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Last Name:</label>
                                            <apex:inputField value="{!app.Last_Name__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Business Phone:</label>
                                            <apex:inputField value="{!app.Business_Phone__c}" style="width: 80%;" styleClass="phone" />
                                        </div>
                                    </div>                                          
                                </div>          

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>*Email Address:</label>
                                            <apex:inputField value="{!app.Email_Address__c}" required="true" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Amount Requested:</label>
                                            <apex:inputField value="{!app.Amount_Requested__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>           

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Years in Business:</label>
                                            <apex:inputField value="{!app.Years_in_Business__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Monthly Gross Sales:</label>
                                            <apex:inputField value="{!app.Montly_Gross_Sales__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>       
                                
                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Monthly Credit Card Sales:</label>
                                            <apex:inputField value="{!app.Monthly_Credit_Card_Sales__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>          

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>(*) - Required</label>        
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- RIGHT COLUMN -->
                            <div class="col-md-6">
                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Business Address (Line 1):</label>
                                            <apex:inputText value="{!app.Address_Line_1__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Business Address (Line 2):</label>
                                            <apex:inputText value="{!app.Address_Line_2__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>           

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>City:</label>
                                            <apex:inputField value="{!app.City__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>State:</label>
                                            <apex:inputField value="{!app.State__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>          

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Postal Code:</label>
                                            <apex:inputField value="{!app.Zip_Postal_Code__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Purpose of Funding:</label>
                                            <apex:inputField value="{!app.Purpose_of_Funding__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>           

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Industry:</label>
                                            <apex:selectList size="1" value="{!app.Industry__c}" style="width: 80%;" styleClass="form-control">
                                                <apex:selectOptions value="{!industries}" />
                                            </apex:selectList>
                                        </div>
                                    </div>                                          
                                </div>

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Federal Tax ID:</label>
                                            <apex:inputField value="{!app.Federal_Tax_ID_Public__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>
                                
                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Current Loan Balances:</label>
                                            <apex:inputField value="{!app.Current_Loan_Balances__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>
                                
                            </div>
                        </div>                        
                    
                        <div class="panel-footer" style="text-align: center;">
                            <input class="btn btn-primary btn-sm" type="button" value="Continue" onclick="changeStage('stage2'); save();" />
                            <input class="btn btn-default btn-sm" type="button" value="Save For Later" onclick="save();" style="float: right;padding-bottom: 8px;padding-top: 8px;" />
                        </div>

                    </div>
                </apex:outputPanel>

                <apex:outputPanel styleClass="stage2" style="display:{!IF(stage != 'stage2', 'none', '')};">

                    <div class="panel panel-default">
                        
                        <!-- STEP 2 SECTION -->                     
                        <div class="panel-heading" style="text-align: center;">
                            <i class="fa fa-question-circle fa-2x tooltip-icon" title="{!settings.Personal_Information_Help_Text__c}" style="float:left;margin-top:1px"/>
                            <input class="btn btn-default btn-sm" type="button" value="Back"           onclick="changeStage('stage1');" />
                            <input class="btn btn-primary btn-sm" type="button" value="Continue"       onclick="changeStage('stage3');" />
                            <input class="btn btn-default btn-sm" type="button" value="Save For Later" onclick="save();" style="float: right;padding-bottom: 8px;padding-top: 8px;" />
                        </div>
                                        
                        <div class="row">
                            <!-- LEFT COLUMN -->
                            <div class="col-md-6">
                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <h4 style="color: #999;">Owner 1</h4>
                                        </div>
                                    </div>                                          
                                </div>

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>First Name:</label>
                                            <apex:inputField value="{!app.Owner_1_First_Name__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>           

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Last Name:</label>
                                            <apex:inputField value="{!app.Owner_1_Last_Name__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Email Address:</label>
                                            <apex:inputField value="{!app.Owner_1_Email_Address__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Phone:</label>
                                            <apex:inputField value="{!app.Owner_1_Home_Phone__c}" style="width: 80%;" styleClass="phone"  />
                                        </div>
                                    </div>                                          
                                </div>           


                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Mobile:</label>
                                            <apex:inputField value="{!app.Owner_1_Mobile__c}" style="width: 80%;" styleClass="phone"  />
                                        </div>
                                    </div>                                          
                                </div>  

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Social Security #:</label>
                                            <apex:inputField value="{!app.Owner_1_SSN_Public__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div> 

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>% Ownership:</label>
                                            <apex:inputField value="{!app.Owner_1_Ownership__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>          

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>(*) - Required</label>        
                                        </div>
                                    </div>
                                </div>                                                                                       
                            </div>

                            <!-- RIGHT COLUMN -->
                            <div class="col-md-6">
                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <h4 style="color: #999;">Owner 2</h4>
                                        </div>
                                    </div>                                          
                                </div>

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>First Name:</label>
                                            <apex:inputField value="{!app.Owner_2_First_Name__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>           

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Last Name:</label>
                                            <apex:inputField value="{!app.Owner_2_Last_Name__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Email Address:</label>
                                            <apex:inputField value="{!app.Owner_2_Email_Address__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Phone:</label>
                                            <apex:inputField value="{!app.Owner_2_Home_Phone__c}" style="width: 80%;" styleClass="phone"  />
                                        </div>
                                    </div>                                          
                                </div>           


                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Mobile:</label> 
                                            <apex:inputField value="{!app.Owner_2_Mobile__c}" style="width: 80%;" styleClass="phone"  />
                                        </div>
                                    </div>                                          
                                </div>  

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>Social Security #:</label>
                                            <apex:inputField value="{!app.Owner_2_SSN_Public__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div> 

                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-12">
                                            <label>% Ownership:</label>
                                            <apex:inputField value="{!app.Owner_2_Ownership__c}" style="width: 80%;" />
                                        </div>
                                    </div>                                          
                                </div>                                
                            </div>
                        </div>
                    
                        <div class="panel-footer" style="text-align: center;">
                            <input class="btn btn-default btn-sm" type="button" value="Back"           onclick="changeStage('stage1');" />
                            <input class="btn btn-primary btn-sm" type="button" value="Continue"       onclick="changeStage('stage3');" />
                            <input class="btn btn-default btn-sm" type="button" value="Save For Later" onclick="save();" style="float: right;padding-bottom: 8px;padding-top: 8px;" />
                        </div>

                    </div>
                </apex:outputPanel>

                <apex:outputPanel styleClass="stage3" rendered="{!stage == 'stage3'}">

                    <div class="panel panel-default">
                        
                        <!-- STEP 3 SECTION -->                     
                        <div class="panel-heading" style="text-align: center;">
                            <i class="fa fa-question-circle fa-2x tooltip-icon" title="{!settings.Upload_Attachments_Help_Text__c}" style="float:left;margin-top:1px"/>
                            <input class="btn btn-default btn-sm" type="button" value="Back" 
                            onclick="changeStage('stage2');" />
                            <input class="btn btn-primary btn-sm" type="button" value="Continue" onclick="changeStage('stage4');" />
                            <input class="btn btn-default btn-sm" type="button" value="Save For Later"  onclick="save();" style="float: right;padding-bottom: 8px;padding-top: 8px;" />
                        </div>
                        
                        <div class="row">                            
                            <div class="col-md-12">                
                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-3 formLabel">
                                            Bank Statement:
                                        </div>
                                        <div class="col-md-6">
                                            <apex:inputFile styleClass="btn btn-default btn-file" value="{!bankStatementsFileBody}" filename="{!bankStatement.File_Name__c}" />
                                        </div>
                                    </div>                                          
                                </div>
                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-3 formLabel">
                                            Credit Card Statement:
                                        </div>
                                        <div class="col-md-6 ">
                                            <apex:inputFile styleClass="btn btn-default btn-file" value="{!creditCardStmtsFileBody}" filename="{!creditCardStatement.File_Name__c}" />
                                        </div>
                                    </div>
                                </div>
                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-3 formLabel">
                                            Copy of Drivers License:
                                        </div>
                                        <div class="col-md-6">
                                            <apex:inputFile styleClass="btn btn-default btn-file" value="{!driversLicenseFileBody}" filename="{!driverLicense.File_Name__c}" />
                                        </div>
                                    </div>
                                </div>
                                <div class="panel-body">
                                    <div class="col-md-12">
                                        <div class="col-md-3 formLabel">
                                            Copy of Voided Check:
                                        </div>
                                        <div class="col-md-6">
                                            <apex:inputFile styleClass="btn btn-default btn-file" value="{!voidedCheckFileBody}" filename="{!voidedCheck.File_Name__c}" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="panel-footer" style="text-align: center;">
                            <input class="btn btn-default btn-sm" type="button" value="Back" onclick="changeStage('stage2');" />
                            <input class="btn btn-primary btn-sm" type="button" value="Continue" onclick="changeStage('stage4');" />
                            <input class="btn btn-default btn-sm" type="button" value="Save For Later"  onclick="save();" style="float: right;padding-bottom: 8px;padding-top: 8px;" />
                        </div>

                    </div>
                </apex:outputPanel>

                <apex:outputPanel styleClass="stage4" style="display:{!IF(stage != 'stage4', 'none', '')};">
                    <div class="panel panel-default">
                        
                        <!-- STEP 4 SECTION -->                     
                        <div class="panel-heading" style="text-align: center;">
                            <i class="fa fa-question-circle fa-2x tooltip-icon" title="{!settings.Submit_Help_Text__c}" style="float:left;margin-top:1px"/>
                            <input class="btn btn-default btn-sm" type="button" value="Back" onclick="changeStage('stage3');" />
                            <input class="btn btn-primary btn-sm" type="button" value="Submit" onclick="submitApplication();" />
                            <input class="btn btn-default btn-sm" type="button" value="Save For Later"  onclick="save();" style="float: right;" />                            
                        </div>

                        <div class="row"> 

                            <div class="col-md-12">                
                                <div class="panel-body subtitlesection" style="border-top: none;">                
                                    <h4>Business Information</h4>
                                </div>  

                                <div class="row">
                                    <!-- LEFT COLUMN -->
                                    <div class="col-md-6">
                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Business Name:</label>
                                                    &nbsp;<apex:outputField value="{!app.Business_Name__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>First Name:</label>
                                                    &nbsp;<apex:outputField value="{!app.First_Name__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>           

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Last Name:</label>
                                                    &nbsp;<apex:outputField value="{!app.Last_Name__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Business Phone:</label>
                                                    &nbsp;<apex:outputField value="{!app.Business_Phone__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>          

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Email Address:</label>
                                                    &nbsp;<apex:outputField value="{!app.Email_Address__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Amount Requested:</label>
                                                    &nbsp;<apex:outputField value="{!app.Amount_Requested__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>           

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Years in Business:</label>
                                                    &nbsp;<apex:outputField value="{!app.Years_in_Business__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Monthly Gross Sales:</label>
                                                    &nbsp;<apex:outputField value="{!app.Montly_Gross_Sales__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>       
                                        
                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Monthly Credit Card Sales:</label>
                                                    &nbsp;<apex:outputField value="{!app.Monthly_Credit_Card_Sales__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>          
                                    </div>

                                    <!-- RIGHT COLUMN -->
                                    <div class="col-md-6">
                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Address (Line 1):</label>
                                                    &nbsp;<apex:outputField value="{!app.Address_Line_1__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Address (Line 2):</label>
                                                    &nbsp;<apex:outputField value="{!app.Address_Line_2__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>           

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>City:</label>
                                                    &nbsp;<apex:outputField value="{!app.City__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>State:</label>
                                                    &nbsp;<apex:outputField value="{!app.State__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>          

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Postal Code:</label>
                                                    &nbsp;<apex:outputField value="{!app.Zip_Postal_Code__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Purpose of Funding:</label>
                                                    &nbsp;<apex:outputField value="{!app.Purpose_of_Funding__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>           

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Industry:</label>
                                                    &nbsp;<apex:outputField value="{!app.Industry__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Federal Tax ID:</label>
                                                    &nbsp;<apex:outputField value="{!app.Federal_Tax_ID_Public__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>
                                        
                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Current Loan Balances:</label>
                                                    &nbsp;<apex:outputField value="{!app.Current_Loan_Balances__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>
                                        
                                    </div>
                                </div>                                 
                            </div>                        

                            <div class="col-md-12">                
                                <div class="panel-body subtitlesection">                
                                    <h4>Personal Information</h4>
                                </div>  

                                <div class="row">
                                    <!-- LEFT COLUMN -->
                                    <div class="col-md-6">
                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <h4 style="color: #999;">Owner 1</h4>
                                                </div>
                                            </div>                                          
                                        </div>

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>First Name:</label>
                                                    &nbsp;<apex:outputField value="{!app.Owner_1_First_Name__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>           

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Last Name:</label>
                                                    &nbsp;<apex:outputField value="{!app.Owner_1_Last_Name__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Email Address:</label>
                                                    &nbsp;<apex:outputField value="{!app.Owner_1_Email_Address__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Phone:</label>
                                                    &nbsp;<apex:outputField value="{!app.Owner_1_Home_Phone__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>           


                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Mobile:</label>
                                                    &nbsp;<apex:outputField value="{!app.Owner_1_Mobile__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>  

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Social Security #:</label>
                                                    &nbsp;<apex:outputField value="{!app.Owner_1_SSN_Public__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div> 

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>% Ownership:</label>
                                                    &nbsp;<apex:outputField value="{!app.Owner_1_Ownership__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>          
                                    </div>

                                    <!-- RIGHT COLUMN -->
                                    <div class="col-md-6">
                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <h4 style="color: #999;">Owner 2</h4>
                                                </div>
                                            </div>                                          
                                        </div>

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>First Name:</label>
                                                    &nbsp;<apex:outputField value="{!app.Owner_2_First_Name__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>           

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Last Name:</label>
                                                    &nbsp;<apex:outputField value="{!app.Owner_2_Last_Name__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Email Address:</label>
                                                    &nbsp;<apex:outputField value="{!app.Owner_2_Email_Address__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Phone:</label>
                                                    &nbsp;<apex:outputField value="{!app.Owner_2_Home_Phone__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>           


                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Mobile:</label>
                                                    &nbsp;<apex:outputField value="{!app.Owner_2_Mobile__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>  

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>Social Security #:</label>
                                                    &nbsp;<apex:outputField value="{!app.Owner_2_SSN_Public__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div> 

                                        <div class="panel-body">
                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label>% Ownership:</label>
                                                    &nbsp;<apex:outputField value="{!app.Owner_2_Ownership__c}" style="width: 80%;" />
                                                </div>
                                            </div>                                          
                                        </div>                                
                                    </div>
                                </div>                                
                            </div>                            

                            <div class="col-md-12">                
                                <div class="panel-body subtitlesection">                
                                    <h4>Attachments</h4>
                                </div>  
                            </div>

                            <div class="col-md-12">                
                                <div class="panel-body" style="padding: 15px;">
                                    <div class="col-md-12">
                                        <div class="col-md-3 formLabel">
                                            Bank Statement:
                                        </div>
                                        <div class="col-md-6">
                                            <apex:outputPanel rendered="{!bankStatement.Id != null}">
                                                <a href="{!URLFOR($Action.Attachment.Download, bankStatement.Attachment_Id__c)}" download="{!bankStatement.File_Name__c}">
                                                    {!bankStatement.File_Name__c}
                                                </a> 
                                                - 
                                                <apex:commandLink action="{!deleteAttachment}" style="font-size: 12px;" onclick="return confirm('Are you sure?');">
                                                    <apex:param name="aid" value="{!bankStatement.Id}" />
                                                    <i class="glyphicon glyphicon-trash" />
                                                </apex:commandLink>
                                            </apex:outputPanel>    
                                            &nbsp;                                        
                                        </div>
                                    </div>                                          
                                </div>       
                                
                                <div class="panel-body" style="padding: 15px;">
                                    <div class="col-md-12">
                                        <div class="col-md-3 formLabel">
                                            Credit Card Statement:
                                        </div>
                                        <div class="col-md-6">
                                            <apex:outputPanel rendered="{!creditCardStatement.Id != null}">
                                                <a href="{!URLFOR($Action.Attachment.Download, creditCardStatement.Attachment_Id__c)}" download="{!creditCardStatement.File_Name__c}">
                                                    {!creditCardStatement.File_Name__c}
                                                </a> 
                                                - 
                                                <apex:commandLink action="{!deleteAttachment}" style="font-size: 12px;" onclick="return confirm('Are you sure?');">
                                                    <apex:param name="aid" value="{!creditCardStatement.Id}" />
                                                    <i class="glyphicon glyphicon-trash" />
                                                </apex:commandLink>
                                            </apex:outputPanel> 
                                            &nbsp; 
                                        </div>
                                    </div>                                          
                                </div>  

                                <div class="panel-body" style="padding: 15px;">
                                    <div class="col-md-12">
                                        <div class="col-md-3 formLabel">
                                            Copy of Drivers License:
                                        </div>
                                        <div class="col-md-6">
                                            <apex:outputPanel rendered="{!driverLicense.Id != null}">
                                                <a href="{!URLFOR($Action.Attachment.Download, driverLicense.Attachment_Id__c)}" download="{!driverLicense.File_Name__c}">
                                                    {!driverLicense.File_Name__c}
                                                </a> 
                                                - 
                                                <apex:commandLink action="{!deleteAttachment}" style="font-size: 12px;" onclick="return confirm('Are you sure?');">
                                                    <apex:param name="aid" value="{!driverLicense.Id}" />
                                                    <i class="glyphicon glyphicon-trash" />
                                                </apex:commandLink>
                                            </apex:outputPanel>  
                                            &nbsp;
                                        </div>
                                    </div>                                          
                                </div>  

                                <div class="panel-body" style="padding: 15px;">
                                    <div class="col-md-12">
                                        <div class="col-md-3 formLabel">
                                            Copy of Voided Check:
                                        </div>
                                        <div class="col-md-6">
                                            <apex:outputPanel rendered="{!voidedCheck.Id != null}">
                                                <a href="{!URLFOR($Action.Attachment.Download, voidedCheck.Attachment_Id__c)}" download="{!voidedCheck.File_Name__c}">
                                                    {!voidedCheck.File_Name__c}
                                                </a> 
                                                - 
                                                <apex:commandLink action="{!deleteAttachment}" style="font-size: 12px;" onclick="return confirm('Are you sure?');">
                                                    <apex:param name="aid" value="{!voidedCheck.Id}" />
                                                    <i class="glyphicon glyphicon-trash" />
                                                </apex:commandLink>
                                            </apex:outputPanel> 
                                            &nbsp; 
                                        </div>
                                    </div>                                          
                                </div>                                                                                                                           
                            </div>
                        </div>

                        <div class="panel-footer" style="text-align: center;">
                            <input class="btn btn-default btn-sm" type="button" value="Back" onclick="changeStage('stage3');" />
                            <input class="btn btn-primary btn-sm" type="button" value="Submit" onclick="submitApplication();" />
                            <input class="btn btn-default btn-sm" type="button" value="Save For Later"  onclick="save();" style="float: right;" />                            
                        </div>

                    </div>
                </apex:outputPanel>

                <apex:outputPanel styleClass="stage5" style="display:{!IF(stage != 'stage5', 'none', '')};">
                    <div class="panel panel-default">
                        
                        <!-- STEP 5 SECTION -->                     
                        <div class="row"> 
                             <div class="col-md-12">                
                                <div class="panel-body submitted">                
                                    <h1>Application Submitted!</h1>
                                    <p>Your application has been submitted to our system.</p>                                    
                                </div>  
                            </div>
                        </div>
                    </div>
                </apex:outputPanel>                
            </div>

            <div id="footer" style="margin-top: 20px;text-align: center;line-height: 20px;">
                &copy; 2015 ACME All Rights Reserved.<br />                
                Powered by <a href="http://www.cloudmybiz.com" target="_blank" style="color: #57B1D1; text-decoration: none;">CloudMyBiz &reg;</a>
            </div>            
        </apex:outputPanel>
    </apex:form>

</apex:page>