<apex:page controller="submissionWizardClass" sidebar="false" >
 <apex:includeScript value="{!urlfor($Resource.MCATableSorter, 'jquery-1.11.1.min.js')}" />

    <style type="text/css">
        #assign-action-spinner-main {
                position: fixed;
                left: 0;
                top: 0;
                background-color:rgba(0,0,0,.6);
                height: 100%;
                width: 100%;
                z-index: 999;
                align: center;
                vertical-align: middle;
            }
            #assign-action-spinner-content {
                position: absolute; 
                top: 50%;
                left: 50%;
                z-index: 1000;
                background-color: #F5FCFF;
                width: 204;
                height: 94; 
                border-radius: 1em;
                border: 1px solid #CEECFF;
                padding: 20px 40px 20px 40px;
                margin-left: -116px;
                margin-top: -36px;
            }
            #assign-action-spinner-content img {
                width: 32;
                height: 32;
                align: center;
                vertical-align: middle;
            }
            #assign-action-spinner-content p {
                display: inline;
                font-size: 135%;
                font-weight: bold;
            }
        #dropbox {
                    width: 90%; 
                    height:30px;
                    padding: 1.145em;
                    margin: 0 auto;
                    margin-bottom:14px;
                    border: 6px white double;
                    color:white;
                    font:weight:bold;
                    font-size:14px;
                    border-color: white !important;
                    border-radius:20px;
                    background-color:#69c;
            }
            
            #preview {
                    display: none;
                    margin: 1.125em auto;
                    border: 1px solid pink;
                }
        .disablingDiv { /* Do not display it on entry */ 
            display: none;
            /* Display it on the layer with index 1001.
                       Make sure this is the highest z-index value
                       used by layers on that page */
            z-index: 3001;
            /* make it cover the whole screen */
            position: absolute;
            top: 0%;
            left: 0%;
            width: 112%;
            height: 102%;
            /* make it white but fully transparent */
            background-color: #ffffff; 
            opacity: .30;
            filter: alpha(opacity = 20);
        }
        body .bPageBlock .pbBody .pbSubheader .showListButton {
            background: url("/img/alohaSkin/twisty_sprite.png") no-repeat scroll 0px -0px transparent;
        }
        body .bPageBlock .pbBody .pbSubheader .hideListButton {
            background: url("/img/alohaSkin/twisty_sprite.png") no-repeat scroll 0px -11px transparent;
        }
        
        
        .custPopup {
            background-color: white;
            border-width: 2px;
            border-style: solid;
            z-index: 9999;
            left: 50%;
            padding: 10px;
            position: absolute;
            /* These are the 3 css properties you will need to change so the popup
                    displays in the center of the screen. First set the width. Then set
                    margin-left to negative half of what the width is. You can add
                    the height property for a fixed size pop up if you want.*/
            width: 500px;
            margin-left: -250px;
            top: 50%;
        }
        
        .summarytable{
            border-collapse:collapse;
            border : 1px solid silver;
            border-left: none;
            border-right: none;
            font-size:.95em;
            font-family:Arial,Helvetica,sans-serif;
            font-weight:normal;
        }
        
        .popupBackground {
            background-color: white;
            opacity: 0.20;
            filter: alpha(opacity =   20);
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 9998;
        }
        .homeTab .tertiaryPalette, .individualPalette .homeBlock .tertiaryPalette, .layoutEdit .individualPalette .homeBlock .tertiaryPalette {
            background-color: #cfeef8;
            border-color: #fff;
        }
        .detailList {
            table-layout: fixed;
            margin-top: 5px;
        }
        .myFormStyle
        {
            color: #fff !important;
            /*background: none repeat scroll 0 0 #ffffff !important;*/
            background-color:white;
        }
        .dealSummaryCls {
            width: 12% !important;
        }
        .labelCol {
            text-align: left !important;
            width: 20% !important;
             padding-left: 0px !important;
        }
        .detailList tr th{padding:0px !Important}
        .bPageBlock th.vfLabelColTextWrap {
              position: relative;
              white-space: nowrap;
          }
        .dataCol {
          width: 21% !important;
           padding: 10px 0px !IMPORTANT;
           //border:solid 1px #f00 !Important
        }
        .data2Col {
            width: 21% !important;
        }
        .empty{
          display:none;
        }
        .classNameForPageBlockSection3{ 
             bgcolor: #26a5e0 !important;
         }
        .detailList th{ text-align:right !important}
        
        body .bPageBlock, body #bodyCell .bResource .secondaryPalette, body .secondaryPalette.bPageBlock, 
        body .individualPalette .secondaryPalette.bPageBlock, body .bodyDiv .genericTable, body .genericPageBlockTable, 
        body .bodyDiv .bSubBlock, body .bComponentBlock .bPageBlock, body .bMyDashboard .bPageBlock, 
        body.rlHoverFrame .bPageBlock, body.subjectSelectionPopup div.choicesBox, 
        body.lookupTab .secondaryPalette.bPageBlock, 
        body.popupTab .secondaryPalette.bPageBlock, body.UserTagStatsPage .secondaryPalette.bPageBlock{
            background-color:#FFFFFF; !important
        }
        body .bPageBlock .detailList tr td, body .bPageBlock .detailList tr th, body table.list tr td,
        body table.list tr th, body .hoverDetail .bPageBlock .detailList tr td,
        body .hoverDetail .bPageBlock .detailList tr th{
            border-color: #ffffff;
        }
        h3 {
            font-size : 100% !important;
            color : #000 !important;
            font-family : Arial !important;
            
        }
        .bDetailBlock.bPageBlock .pbBody .labelCol, body .bDetailBlock.bPageBlock .pbBody .dataCol, body .bDetailBlock.bPageBlock .pbBody .data2Col, body .bPageBlock.bEditBlock .pbBody .labelCol, body .bPageBlock.bEditBlock .pbBody .dataCol, body .bPageBlock.bEditBlock .pbBody .data2Col {
            padding-top: 3px;
            padding-bottom: 3px;
            padding-left: 20px;
            //width: 50% !important;
        }
        .bPageBlock .detailList tr td, .bPageBlock .detailList tr th, .hoverDetail .bPageBlock .detailList tr td, .hoverDetail .bPageBlock .detailList tr th {
            border-bottom: 1px solid #E3DEB8;
            padding: 26px 0px;
            padding-top: 10px !important;
            padding-bottom: 8px !important;
        }
        .bPageBlock .detailList tr:first {
            padding-top: 13px !important;
        }
        /*
        .pbSubsection {
            margin-bottom: -15px;
        }*/
        .setWidth{
            max-width: 100% !important;
            width: 100%;
            color: #4a4a56;
            font-size: 95%;
        }
        



element.style {
    /* margin-left: 20px; */
}
.pbBody, .pbBody a, .pbBody td, .lbBody a, .lbBodyDescription, .list .headerRow .noRowsHeader {
    color: #000;
}
a {
    color: #333435;
}
a {
    color: #333;
}
user agent stylesheeta:-webkit-any-link {
    color: -webkit-link;
    text-decoration: underline;
    cursor: auto;
}
.bPageBlock .dataCol {
    
    text-align: -webkit-center;
    -webkit-column-count: 2; 
    -moz-column-count: 2; 
    -webkit-column-gap: 5px;
    -moz-column-gap: 5px; 
    
    
}
        
        .hideListButton {cursor:pointer;}
        .showListButton {cursor:pointer;}
        .pbSubheader {text-align:left;}
        .test{font-family: 'Arial','Helvetica',sans-serif; font-size:12px; font-weight:bold}
    </style>
    
    <!-- script to check all the checkboxes -->
    <script type="text/javascript">
        function checkAll(cb,cbid)
        {
            var inputElem = document.getElementsByTagName("input");
            for(var i=0; i<inputElem.length; i++)
            {            
                 if(inputElem[i].id.indexOf(cbid)!=-1){
                    inputElem[i].checked = cb.checked;
                }
            }
        }
        function colorPageBlock(pageblock, color) {
            if (pageblock != null) pageblock.firstChild.style.cssText = "background-color:#fff !important; color:#000 !important; border-top: #8499a5 solid 2px !important; font-size: 13px !important; margin-bottom: -10px !important;";//+ color + ";";
            
            } 
            
        function twistSection(twisty, sectionId) {
           var parentDiv = twisty;
           while (parentDiv.tagName != 'DIV') { parentDiv = parentDiv.parentNode; }
           var div = parentDiv.nextSibling; 
           var elemWasOn = false; 
           if (pbSubsection.style.display != 'none') { 
               pbSubsection.style.display = 'none'; 
               twisty.className ='showListButton';
               twisty.alt = twisty.title = 'Show Section - '+twisty.name;
               elemWasOn = true; 
           } else {
               pbSubsection.style.display = 'block'; 
               twisty.className = 'hideListButton';
               twisty.alt = twisty.title = 'Hide Section - '+twisty.name;
           } 
          return !elemWasOn;
        }
    </script>
    <script type="text/javascript">
        function showDisablingDiv()
        {     
            //alert('in disabling div');
            document.getElementById('disablingDiv').style.display='block';
        } 
        
        function hideDisablingDiv()
        {
            //alert('in hide disabling div');
            document.getElementById('disablingDiv').style.display='none';
        }
        function focusOn(val)
        {
            var checkboxId = val;           
            document.getElementById(checkboxId).focus();
        }
        function ClosePage(){
            //alert('test');
            //window.top.close();
        }
    </script>

    <apex:includeScript value="/support/console/22.0/integration.js"/>

    <apex:form id="form">
        
        <apex:pageMessages id="pageMessageId" escape="false"/>
        <div align="left" class="disablingDiv" id="disablingDiv"></div>

        <center>
        <div style="position:absolute;top: 50%;left: 350px;" >
            <apex:actionStatus stopText="" id="counterStatusSave">
                <apex:facet name="start">
                     <apex:outputPanel style="padding-left:50%;">
                        <apex:image value="{!$Resource.Loading}" width="50%" height="50%"/>
                     </apex:outputPanel>             </apex:facet>
            </apex:actionStatus>
        </div>
        </center>
        <apex:actionFunction name="resetAtt" action="{!resetAttachments}"  
                                             rerender="pgmTable,pageMessageId,attachmentTable" 
                                             status="loadingAttachment"/>

        <apex:actionFunction name="checkUncheckAtt" action="{!checkUncheckAttachements}"  
                                            rerender="pageMessageId,attachmentTable" 
                                             status="loadingAttachment" oncomplete="hideDisablingDiv();">
            <apex:param name="isSelected" value=""/> 
            <apex:param name="attId"  value=""/> 
        </apex:actionFunction>

        <!-- Code for the popup -->
         <apex:outputPanel id="tstpopup">
            <apex:outputPanel styleClass="popupBackground" layout="block" rendered="{!displayPopUp}" id="parentPopup"/>
                <apex:outputPanel styleClass="custPopup" layout="block" rendered="{!displayPopUp}" id="actPopup">
                    <apex:pageBlock title="Required Documents" id="popup">
                        <apex:repeat value="{!prgmDocMap}" var="pgm">
                            <!--       <apex:variable value="{!1}" var="rowNum"/> -->
                            <b><apex:outputText value="{!pgm}"/></b><br/>
                            <apex:dataList value="{!prgmDocMap[pgm]}" var="doc">
<!--                                <apex:outputText value="{!FLOOR(rowNum)}"/> - -->
                                 <apex:outputText value="{!doc}"/>
<!--                                <apex:variable var="rowNum" value="{!rowNum + 1}"/><br/> -->
                            </apex:dataList>
                        </apex:repeat>
                        <apex:outputText Value="There are no Required Documents for the selected Programs" rendered="{!MapSize}"/> 
                     </apex:pageBlock>
                     <div align="center"> 
                        <apex:commandButton value="Close" action="{!closePopup}" rerender="tstpopup" status="loadingStatus"/>
                    </div>
                </apex:outputPanel>
            </apex:outputPanel>
        <!--    End of Popup -->


        <apex:pageBlock title="Submission Wizard" rendered="{!NOT(showThankYouPage)}" mode="maindetail">

            <div align="right" style="background-color:#FFFFFF; text-decoration: none;color: #26a5e0;margin-top: -23px; padding-bottom: 15px !important ">
                 <apex:outputLink value="{!URLFOR($Action.Opportunity.View,oppId, null,true)}" style=" text-decoration: none;"> <apex:outputText value="<< Back to Opportunity" style="color: #26a5e0; border-bottom: 1px solid #26a5e0;"/> </apex:outputLink>
            </div>
            
<!--             <apex:pageBlockSection title="Deal Summary" collapsible="true" id="summaryInfo" columns="7" > -->
            <style>
            .mainTitle{text-align:left}
            .test-new td{min-height:100px; padding:10px;font-size: 96%; text-align: left;
                    font-family: Arial;text-align: left;}
            .test-new th{min-height:100px; padding:10px;text-align: right;
                    font-weight: bold;color: #4a4a56;font-family: Arial;
                    white-space: nowrap; font-size: 95%;}
                    <!-- APEX REPEAT SWDealSummary Field Set values -->
               .detailList td{    text-align: left !important;
    padding: 0px 0px 0px 20px !important;}
            </style>
            <div style="color: rgb(0, 0, 0) !important; border-top-color: rgb(132, 153, 165) !important;
                    border-top-style: solid !important; border-top-width: 2px !important; margin-bottom: 5px !important;" ></div>
            <b><apex:outputText value="Deal Summary" style="text-align:left; font-size: 115%; margin-left: 10px;"/></b>
<!--             <h2 style="font-size: 115%; margin-left: -1050px; !important">Deal Summmary</h2> -->
            
            <apex:pageBlockSection columns="4">
              <apex:repeat value="{!fields}" var="fldSet" >
<!--                 <table> -->
                    <apex:outputField value="{!oppFieldSet[fldSet.fieldPath]}" />
<!--                       required="{!OR(fldSet.required, fldSet.dbrequired)}"/> -->
<!--                 </table> -->

              </apex:repeat>
            <apex:outputPanel ></apex:outputPanel>
            </apex:pageBlockSection>
<!--             </apex:pageBlockSection> -->
            
<!--             <table cellpadding="10" class="test-new" width="100%"> -->
<!--                 <tr> -->
<!--                     <th><apex:outputLabel value="{!$ObjectType.Account.Fields.Name.Label}"/></th> -->
<!--                     <td><apex:outputText value="{!Opp.Account.Name}" style="text-align: left !important;"/></td> -->
<!--                     <th><apex:outputLabel value="{!$ObjectType.Opportunity.Fields.Amount_Requested__c.Label}" /></th> -->
<!--                     <td><apex:outputText value="{!Opp.Amount_Requested__c}"/></td> -->
<!--                     <th><apex:outputLabel value="Credit Score"/></th> -->
<!--                     <td><apex:outputText value="{!Opp.Credit_Score__c}"/></td> -->
<!--                     <th><apex:outputLabel value="$ Open Balance"/></th> -->
<!--                     <td><apex:outputText value="{!Opp.Total_Loan_Balance__c}"/></td> -->
<!--                 </tr> -->
<!--                 <tr> -->
<!--                     <th><apex:outputLabel value="State"/></th> -->
<!--                     <td><apex:outputText value="{!Opp.Account.BillingState}"/></td> -->
<!--                     <th><apex:outputLabel value="{!$ObjectType.Opportunity.Fields.Gross_monthly_Sales__c.Label}"/></th> -->
<!--                     <td><apex:outputText value="{!Opp.Gross_monthly_Sales__c}"/></td> -->
<!--                     <th><apex:outputLabel value="{!$ObjectType.Opportunity.Fields.Avg_Number_Bank_Deposits__c.Label}"/></th> -->
<!--                     <td><apex:outputText value="{!Opp.Avg_Number_Bank_Deposits__c}"/></td> -->
<!--                     <th><apex:outputLabel value=" # Open Balances"/></th> -->
<!--                     <td><apex:outputText value="{!Opp.No_of_Funders__c}"/></td> -->
<!--                 </tr> -->
<!--                 <tr> -->
<!--                     <th><apex:outputLabel value="{!$ObjectType.Account.Fields.Industry.Label}"/></th> -->
<!--                     <td><apex:outputField value="{!Opp.Account.Industry}"/></td> -->
<!--                     <th><apex:outputLabel value="{!$ObjectType.Opportunity.Fields.Credit_Card_Sales__c.Label}"/></th> -->
<!--                     <td><apex:outputField value="{!Opp.Credit_Card_Sales__c}"/></td> -->
<!--                     <th><apex:outputLabel value="{!$ObjectType.Opportunity.Fields.NSFs_avg__c.Label}"/></th> -->
<!--                     <td><apex:outputField value="{!Opp.NSFs_avg__c}"/></td> -->
<!--                     <th rowspan="3"><apex:outputLabel value="{!$ObjectType.Opportunity.Fields.Submission_Notes__c.Label}"/></th> -->
<!--                     <td style="width:20%" rowspan="3"><apex:outputField value="{!Opp.Submission_Notes__c}"/></td> -->
<!--                 </tr> -->
<!--                 <tr> -->
<!--                     <th><apex:outputLabel value="{!$ObjectType.Account.Fields.Years_in_Business__c.Label}"/></th> -->
<!--                     <td><apex:outputField value="{!Opp.Account.Years_in_Business__c}"/></td> -->
<!--                     <th><apex:outputLabel value="{!$ObjectType.Opportunity.Fields.Average_Daily_Balance__c.Label}"/></th> -->
<!--                     <td> <apex:outputField value="{!Opp.Average_Daily_Balance__c}"/></td> -->
<!--                     <th><apex:outputLabel value="{!$ObjectType.Opportunity.Fields.NDBs_avg__c.Label}"/></th> -->
<!--                     <td><apex:outputField value="{!Opp.NDBs_avg__c}"/></td> -->
<!--                 </tr> -->
<!--                 <tr> -->
<!--                     <th><apex:outputLabel value="{!$ObjectType.Opportunity.Fields.Batches__c.Label}"/></th> -->
<!--                     <td><apex:outputField value="{!Opp.Batches__c}"/></td> -->
<!--                     <th><apex:outputLabel value="{!$ObjectType.Opportunity.Fields.Transactions__c.Label}"/></th> -->
<!--                     <td><apex:outputField value="{!Opp.Transactions__c}"/></td> -->
<!--                 </tr> -->
<!--             </table> -->

            <apex:pageBlockSection id="programs"  columns="1" collapsible="false">
            
                <script>colorPageBlock(document.getElementById("{!$Component.programs}"), "#26a5e0");</script>
                <h3 style="font-size: 115%;margin-left: -15px; ">Programs</h3><br></br>
            </apex:pageBlockSection><br></br>
            <div style="width:100%">
            <apex:outputPanel title="Programs" style="margin-left: -1060px !important;"><br></br>

                <table style="width:100%" cellspacing="2" cellpadding="5" border="0">
                    <tr>
                        <th>
                           <apex:outputLabel value="Credit Score" styleClass="setWidth"/>
                        </th>
                        <th >
                            <apex:outputLabel value="Years in Business" styleClass="setWidth"/>
                        </th>
                        <th >
                            <apex:outputLabel value="Monthly Deposits $" styleClass="setWidth"/>
                        </th>
                        <th >
                            <apex:outputLabel value="Monthly Deposits #" styleClass="setWidth"/>
                        </th>
                        <th >
                             <apex:outputLabel value="Avg Daily Balance" styleClass="setWidth"/>
                        </th>
                         <th >
                            <apex:outputLabel value="Max NSFs" styleClass="setWidth"/>
                        </th>
                         <th >
                            <apex:outputLabel value="Max NDBs" styleClass="setWidth"/>
                        </th>
                        <th >
                              <apex:outputLabel value="Industry" styleClass="setWidth"/>
                        </th>
                        <th >
                              <apex:outputLabel value="State" styleClass="setWidth"/>
                        </th>
                        <th >
<!--                             <apex:image url="{!$Resource.SubmissioWizard_Star}" /> -->
                              <apex:outputLabel value="Preferred Programs" styleClass="setWidth"/>
                        </th>
                  </tr>
                  <tr>
                        <td>
                            <apex:inputText value="{!creditScore}" onkeypress="return noenter(event);" styleClass="setWidth"/>
                        </td>
                        <td>
                            <apex:inputText value="{!yearInBusiness}" onkeypress="return noenter(event);" styleClass="setWidth"/>
                        </td>
                        <td>
                            <apex:inputText value="{!minMonthlyDeposite}" onkeypress="return noenter(event);" styleClass="setWidth"/>
                        </td>
                        <td>
                            <apex:inputText value="{!minDepositeCount}" onkeypress="return noenter(event);" styleClass="setWidth"/>
                        </td>
                        <td>
                            <apex:inputText value="{!minAvgDailyBalance}" onkeypress="return noenter(event);" styleClass="setWidth"/>
                        </td>
                        <td>
                            <apex:inputText value="{!maxNSFs}" onkeypress="return noenter(event);" styleClass="setWidth"/>
                        </td>
                        <td>
                            <apex:inputText value="{!maxNDBs}" onkeypress="return noenter(event);" styleClass="setWidth"/>
                        </td>
                        <td>
                            <apex:inputCheckbox value="{!restrictedIndustry}" onkeypress="return noenter(event);" styleClass="setWidth"/>
                        </td>
                        <td>
                            <apex:inputCheckbox value="{!restrictedState}" onkeypress="return noenter(event);" styleClass="setWidth"/>
                        </td>
                        <td>
                            <apex:inputCheckbox value="{!prefferedProgram}" onkeypress="return noenter(event);" styleClass="setWidth"/>
                        </td>
                    </tr>
                </table>

                <div align="center" style="background-color:#FFFFFF; margin-top: 10px;">
                    <apex:commandButton id="filterBtn" value="Filter" 
                                                       action="{!getPrograms}" 
                                                       rerender="pgmTable,pageMessageId,attachmentTable" status="loadingStatus"
                                                       onclick="showDisablingDiv();"
                                                       oncomplete="hideDisablingDiv();"/>
                    &nbsp;&nbsp;
                    <apex:commandLink value="Clear Filters" action="{!clearFilter}" rerender="form" status="loadingStatus"
                                                              onclick="showDisablingDiv();"
                                                              oncomplete="hideDisablingDiv();" />
                     &nbsp;&nbsp;
                     <apex:actionStatus id="loadingStatus" stopText="">
                        <apex:facet name="start">
                        <apex:outputPanel >
                            <apex:image url="/img/loading.gif" />
                            <apex:outputLabel value=" "/>         
                        </apex:outputPanel>                 
                        </apex:facet>
                    </apex:actionStatus>
                    <script type="text/javascript" >
                        function noenter(e){
                            if(window.event){
                                key = window.event.keyCode; //IE
                            }else{
                                key = e.which; //firefox
                            }
                            if(key == 13) {
                                var ele=document.getElementById("{!$Component.filterBtn}").id;
                                document.getElementById(ele).click();
                                return false;
                            } else{
                                return true;
                            }
                        }
                      </script>
                </div>
              
            </apex:outputPanel>
            </div>
            <br/>
            
             <apex:outputPanel id="pgmTable"> 
<!--              style="overflow:scroll;height:800px;" layout="block"> -->
                 <apex:pageBlockTable value="{!programWrapperList1}" var="pgmWrapper" id="table">
                     <apex:column >
                        <apex:facet name="header"> 
                            <apex:inputCheckbox onclick="checkAll(this,'checkBox');resetAtt()" >
                                
                            </apex:inputCheckbox>
                            </apex:facet>
                             <!--   <apex:actionSupport event="onchange" rerender="table"/>-->
                        <apex:inputCheckbox value="{!pgmWrapper.isSelected}" id="checkBox">
<!--                                   onclick="focusOn(this.id);selDesAtt('{!pgmWrapper.isSelected}','{!pgmWrapper.prgm.Id}')"  > -->
                            
                                       <!--onclick="focusOn(this.id);showDisablingDiv();selDesAtt('{!pgmWrapper.isSelected}','{!pgmWrapper.prgm.Id}')"  >-->
                        </apex:inputCheckbox>
                    </apex:column>
                     <apex:column value="{!pgmWrapper.prgm['Bank__c']}">
                        <apex:facet name="header">
                            <apex:commandLink action="{!ViewSortedData_Program}" value="Bank{!IF(sortExpression=='Bank__r.Name',IF(sortDirection='ASC','▲','▼'),'')}" id="cmdSortBankName" reRender="pgmTable" status="loadingStatus">
                                <apex:param value="Bank__r.Name" name="column" assignTo="{!sortExpression}" ></apex:param>

                            </apex:commandLink>
                        </apex:facet>
                     </apex:column>
                     <apex:column >
                       <a href="{!URLFOR($Action.Program__c.View,pgmWrapper.prgm['Id'], null,true)}" id="{!pgmWrapper.prgm['Id']}" 
                                    onmouseover="LookupHoverDetail.getHover('{!pgmWrapper.prgm['Id']}', '/{!pgmWrapper.prgm['Id']}/m?retURL={!pgmWrapper.prgm['Id']}&isAjaxRequest=1').show();"
                    onmouseout="LookupHoverDetail.getHover('{!pgmWrapper.prgm['Id']}').hide();"
                    onfocus="LookupHoverDetail.getHover('{!pgmWrapper.prgm['Id']}', '/{!pgmWrapper.prgm['Id']}/m?retURL={!pgmWrapper.prgm['Id']}&isAjaxRequest=1').show();"
                    onblur="LookupHoverDetail.getHover('{!pgmWrapper.prgm['Id']}').hide();" > 
                            {!pgmWrapper.prgm['Name']}
                        </a>
                        <apex:facet name="header">   
                            <apex:commandLink action="{!ViewSortedData_Program}" value="Program Name{!IF(sortExpression=='Name',IF(sortDirection='ASC','▲','▼'),'')}" id="cmdSortName" reRender="pgmTable" status="loadingStatus">
                                <apex:param value="Name" name="column" assignTo="{!sortExpression}" ></apex:param>
                            </apex:commandLink>
                        </apex:facet>   
                     </apex:column> 
                     <apex:column style="text-align:center;">
                    
                        <apex:facet name="header">
                            <apex:commandLink action="{!ViewSortedData_Program}" value="Credit Score{!IF(sortExpression=='Credit_Score__c',IF(sortDirection='ASC','▲','▼'),'')} " id="cmdSortCreditScore" reRender="pgmTable" status="loadingStatus">
                                <apex:param value="Credit_Score__c" name="column" assignTo="{!sortExpression}" ></apex:param>
                         </apex:commandLink>
                        </apex:facet>
                         <apex:image url="/img/msg_icons/confirm16.png" rendered="{!IF(contains(pgmWrapper.matchingPer, "Credit_Score__c"), true , false)}" style="float:left;"/>
                         <apex:image url="/img/msg_icons/error16.png" rendered="{!IF(contains(pgmWrapper.matchingPer, "Credit_Score__c"), false, true)}" style="float:left;"/>
                        <apex:outputField value="{!pgmWrapper.prgm['Credit_Score__c']} " />
                    </apex:column>
                    <apex:column style="text-align:center;">
                        <apex:facet name="header">
                            <apex:commandLink action="{!ViewSortedData_Program}" value="Years in Biz{!IF(sortExpression=='Years_in_Business__c',IF(sortDirection='ASC','▲','▼'),'')}" id="cmdSortYearsInBui" reRender="pgmTable" status="loadingStatus">
                                <apex:param value="Years_in_Business__c" name="column" assignTo="{!sortExpression}" ></apex:param>
                            </apex:commandLink>
                        </apex:facet>
                        <apex:image url="/img/msg_icons/confirm16.png" rendered="{!IF(contains(pgmWrapper.matchingPer, "Years_in_Business__c"), true, false)}" style="float:left"/>
                         <apex:image url="/img/msg_icons/error16.png" rendered="{!IF(contains(pgmWrapper.matchingPer, "Years_in_Business__c"), false , true)}" style="float:left;"/>     
                        <apex:outputField value="{!pgmWrapper.prgm['Years_in_Business__c']}"/>
                    </apex:column>
                    
<!--                     {!URLFOR($Resource.ManageRenewalMatchingPercent,'images/green.jpg')} -->
                    <apex:column style="text-align:center;">
                        <apex:facet name="header">   
                            <apex:commandLink action="{!ViewSortedData_Program}" value="$ Deposits{!IF(sortExpression=='Min_Monthly_Deposits__c',IF(sortDirection='ASC','▲','▼'),'')}" id="cmdSortMinMonthly" reRender="pgmTable" status="loadingStatus">
                                <apex:param value="Min_Monthly_Deposits__c" name="column" assignTo="{!sortExpression}" ></apex:param>
                            </apex:commandLink>
                        </apex:facet>
                        <apex:image url="/img/msg_icons/confirm16.png" rendered="{!IF(contains(pgmWrapper.matchingPer, "Min_Monthly_Deposits__c"), true, false)}" style="float:left;"/>
                         <apex:image url="/img/msg_icons/error16.png" rendered="{!IF(contains(pgmWrapper.matchingPer, "Min_Monthly_Deposits__c"), false , true)}" style="float:left;"/> 
                         <apex:outputText value="{0,number,$###,###}">
                              <apex:param value="{!FLOOR(pgmWrapper.prgm['Min_Monthly_Deposits__c'])}" />
                        </apex:outputText>
                    </apex:column>

                     <apex:column style="text-align:center;">
                        <apex:facet name="header">   
                            <apex:commandLink action="{!ViewSortedData_Program}" value="# Deposits{!IF(sortExpression=='Minimum_Deposit_Count__c',IF(sortDirection='ASC','▲','▼'),'')}" id="cmdSortDepositCount" reRender="pgmTable" status="loadingStatus">
                                <apex:param value="Minimum_Deposit_Count__c" name="column" assignTo="{!sortExpression}" ></apex:param>
                            </apex:commandLink>
                        </apex:facet>
                        <apex:image url="/img/msg_icons/confirm16.png" rendered="{!IF(contains(pgmWrapper.matchingPer, "Minimum_Deposit_Count__c"), true, false)}" style="float:left;"/>
                         <apex:image url="/img/msg_icons/error16.png" rendered="{!IF(contains(pgmWrapper.matchingPer, "Minimum_Deposit_Count__c"), false , true)}" style="float:left;"/> 
                        <apex:outputField value="{!pgmWrapper.prgm['Minimum_Deposit_Count__c']}"/>
                    </apex:column>
                  <apex:column style="text-align:center;">
                        <apex:facet name="header">   
                            <apex:commandLink action="{!ViewSortedData_Program}" value="Avg Daily Balance{!IF(sortExpression=='Min_Avg_Daily_Bal__c',IF(sortDirection='ASC','▲','▼'),'')}" id="cmdSortDailyBalance" reRender="pgmTable" status="loadingStatus">
                                <apex:param value="Min_Avg_Daily_Bal__c" name="column" assignTo="{!sortExpression}" ></apex:param>
                            </apex:commandLink>
                        </apex:facet>
                        <apex:image url="/img/msg_icons/confirm16.png" rendered="{!IF(contains(pgmWrapper.matchingPer, "Min_Avg_Daily_Bal__c"), true, false)}" style="float:left;"/>
                         <apex:image url="/img/msg_icons/error16.png" rendered="{!IF(contains(pgmWrapper.matchingPer, "Min_Avg_Daily_Bal__c"), false , true)}" style="float:left;"/>
                        <apex:outputText value="{0,number,$###,###}">
                              <apex:param value="{!pgmWrapper.prgm.Min_Avg_Daily_Bal__c}" />
                        </apex:outputText>
                    </apex:column>
                    <apex:column style="text-align:center;">
                        <apex:facet name="header">
                            <apex:commandLink action="{!ViewSortedData_Program}" value="Max NSFs{!IF(sortExpression=='Max_No_NSFs__c',IF(sortDirection='ASC','▲','▼'),'')}" id="cmdSortMaxNSF" reRender="pgmTable" status="loadingStatus">
                                <apex:param value="Max_No_NSFs__c" name="column" assignTo="{!sortExpression}" ></apex:param>
                            </apex:commandLink>
                        </apex:facet>
                        <apex:image url="/img/msg_icons/confirm16.png" rendered="{!IF(contains(pgmWrapper.matchingPer, "NSFs_Avg__c"), true, false)}" style="float:left;"/>
                        <apex:image url="/img/msg_icons/error16.png" rendered="{!IF(contains(pgmWrapper.matchingPer, "NSFs_Avg__c"), false , true)}" style="float:left;"/>
                        <apex:outputField value="{!pgmWrapper.prgm['Max_No_NSFs__c']}"/>
                    </apex:column>
                    <apex:column style="text-align:center;">
                        <apex:facet name="header">
                            <apex:commandLink action="{!ViewSortedData_Program}" value="Max NDBs{!IF(sortExpression=='Max_NDBs__c',IF(sortDirection='ASC','▲','▼'),'')}" id="cmdSortMaxNDB" reRender="pgmTable" status="loadingStatus">
                                <apex:param value="Max_NDBs__c" name="column" assignTo="{!sortExpression}" ></apex:param>
                            </apex:commandLink>
                        </apex:facet>
                        <apex:image url="/img/msg_icons/confirm16.png" rendered="{!IF(contains(pgmWrapper.matchingPer, "Max_NDBs__c"), true, false)}" style="float:left;"/>
                        <apex:image url="/img/msg_icons/error16.png" rendered="{!IF(contains(pgmWrapper.matchingPer, "Max_NDBs__c"), false , true)}" style="float:left;"/>
                        <apex:outputField value="{!pgmWrapper.prgm['Max_NDBs__c']}"/>
                    </apex:column>
                    <apex:column style="text-align:center;">
                        <apex:facet name="header">   
                            <apex:commandLink action="{!ViewSortedData_Program}" value="Max Amount{!IF(sortExpression=='Max_Amount__c',IF(sortDirection='ASC','▲','▼'),'')}" id="cmdSortMaxAmt" reRender="pgmTable" status="loadingStatus">
                                <apex:param value="Max_Amount__c" name="column" assignTo="{!sortExpression}" ></apex:param>
                            </apex:commandLink>
                        </apex:facet>
                        <apex:outputText value="{0,number,$###,###}">
                              <apex:param value="{!FLOOR(pgmWrapper.prgm['Max_Amount__c'])}" />
                        </apex:outputText>
                    </apex:column>

                    <apex:column style="text-align:center;">
                        <apex:facet name="header">   
                            <apex:commandLink action="{!ViewSortedData_Program}" value="Commission %{!IF(sortExpression=='Commission_Percentage__c',IF(sortDirection='ASC','▲','▼'),'')}" id="cmdSortCommPer" reRender="pgmTable" status="loadingStatus">
                                <apex:param value="Commission_Percentage__c" name="column" assignTo="{!sortExpression}" ></apex:param>
                            </apex:commandLink>
                        </apex:facet>
                        <apex:outputField value="{!pgmWrapper.prgm['Commission_Percentage__c']}"/>
                    </apex:column>
                                         
                     <apex:column style="text-align:center;">
                        <apex:outputText value="{0,number,$###,###}">
                              <apex:param value="{!pgmWrapper.PotentialFundingAmt}" />
                        </apex:outputText>
                        <apex:facet name="header" >
                            <apex:commandLink action="{!ViewSortedData_Program}" value="Potential Funding Amt.{!IF(sortExpression=='Funding_Amt_of_Monthly_Gross_Sales__c',IF(sortDirection='ASC','▲','▼'),'')}" id="cmdSortPotFundAmt" reRender="pgmTable" status="loadingStatus">
                                <apex:param value="Funding_Amt_of_Monthly_Gross_Sales__c" name="column" assignTo="{!sortExpression}" ></apex:param>
                            </apex:commandLink>
                        </apex:facet>
                     </apex:column>
                     
                     <apex:column width="145px">
                        <apex:outputPanel rendered="{!NOT(pgmWrapper.missingInfo)}">
                            <apex:outputPanel >
                                <apex:image value="/img/samples/color_green.gif" width="{!pgmWrapper.score}" height="12" />
                                <apex:image value="/img/samples/color_yellow.gif" width="{!(100 - pgmWrapper.score)}" height="12" />
                            </apex:outputPanel>&nbsp;
                            <apex:outputText value="{0,number,###}">
                                  <apex:param value="{!pgmWrapper.score}" />
                            </apex:outputText>%
                        </apex:outputPanel>
                        
                        <apex:outputPanel rendered="{!(pgmWrapper.missingInfo)}">
                            <apex:outputText value="Missing Info" style="color:Red;"/>
                        </apex:outputPanel>
                        
                        <apex:facet name="header" >
                            <apex:commandLink action="{!ViewSortedData_Program}" value="Matching %{!IF(sortExpression=='score',IF(sortDirection='ASC','▲','▼'),'')}" id="cmdSortScore" reRender="pgmTable" status="loadingStatus">
                                <apex:param value="score" name="column" assignTo="{!sortExpression}" ></apex:param>
                            </apex:commandLink>
                        </apex:facet>       
                     </apex:column>
                 </apex:pageBlockTable>
                 <apex:outputText value="No Programs for this criteria" rendered="{!programWrapperList1.size == 0}"/>
                 <br/>
<!--                {!programWrapperList1.size}--{!programWrapperList.size}--{!limitval} -->
              <apex:commandLink value="Show More>>" id="shwmore" action="{!showMore}" 
                                reRender="pgmTable"  status="loadingAttachment" 
                                style="display:{!IF(OR(programWrapperList1.size >= programWrapperList.size),'none','block')};
                                color: #26a5e0; !important"></apex:commandLink>
                <apex:outputPanel style="margin-left: 1120px;">
<!--                 <apex:outputText > -->
                                      {!(QueryRecord.pageNumber * sizeOfProgram)+1-sizeOfProgram} - 
                                      {!IF((QueryRecord.pageNumber * sizeOfProgram)>noOfRecords,
                                      noOfRecords,(QueryRecord.pageNumber * sizeOfProgram))} of {!noOfRecords}
<!--                 </apex:outputText> -->
                </apex:outputPanel>
            </apex:outputPanel> 
            
            <div align="center"> 
                <apex:commandButton value="Check Required Document" action="{!checkReqdDocument}"
                                    rerender="tstpopup" status="loadingStatus" id="delayBtn" />
                <apex:commandButton value="Select Attachments" action="{!selectDeselectAtt1}"
                                    rerender="attachmentTable" status="loadingStatus"  />
            </div>
        </apex:pageBlock>
          
        <apex:pageBlock rendered="{!NOT(showThankYouPage)}">
       
<!--             <apex:pageBlockSection title="Add Multiple Attachment" > -->
<!--                 <apex:outputPanel id="dragDropSection"> -->
<!--                     <div style="border-width:2px;border:4px #69c;height:auto;width:auto;border-radius:17px;">  &nbsp;  -->
<!--                         <div id="dropbox"> -->
<!--                             <center><span id="droplabel">Drop files to attach</span></center> -->
<!--                         </div> -->
<!--                         <apex:outputPanel id="Op1"> -->
<!--                             <img id="preview" src="" alt="[ image will display here ]" /> -->
<!--                         </apex:outputPanel> -->
<!--                     </div> -->
<!--                 </apex:outputPanel> -->
<!-- <!--                <c:AttachmentOnSubmissionWizardComponent /> --> 
<!--             </apex:pageBlockSection> -->
           
        </apex:pageBlock> 
        
         <!-- <div align="right" style = "border-top: 2px solid #8499A5 !important;"></div> -->
        <apex:pageBlock title="Available Attachments" rendered="{!NOT(showThankYouPage)}">   
            <apex:outputPanel id="attachmentTable">   
                <apex:pageBlockTable value="{!AttachmentWrapperList}" var="attachmentWrapper" >
                     <apex:column value="{!attachmentWrapper.cnt}"/>    
                     
                     <apex:column value="{!attachmentWrapper.attachment['name']}">
                        <apex:facet name="header" >
                            <apex:outputText value="Name"/>
                         </apex:facet>  
                     </apex:column>     
                     
                     <apex:column value="{!attachmentWrapper.attachment['Description']}">
                        <apex:facet name="header" >
                            <apex:outputText value="Description"/>
                         </apex:facet> 
                     </apex:column>     
                     
                     <apex:column >
                         <apex:facet name="header" >
                            <apex:outputText value="Programs"/>
                         </apex:facet> 
                         <apex:selectList value="{!attachmentWrapper.selectedPrograms}" multiselect="true">
                            <apex:selectOptions value="{!attachmentWrapper.options}"/>
                         </apex:selectList>
                     </apex:column>
                     <apex:column >
                        <apex:facet name="header"> 
                            <apex:outputText value="Include"/>
                         </apex:facet>
                        <apex:inputCheckbox value="{!attachmentWrapper.isRequired}" 
                                            onclick="checkUncheckAtt('{!attachmentWrapper.isRequired}','{!attachmentWrapper.attachment.Id}');showDisablingDiv();">
                        </apex:inputCheckbox>
                    </apex:column>
                    
                 </apex:pageBlockTable>
                 <apex:outputText style="margin-left: -975px;" value="No Attachments were found" rendered="{!AttachmentWrapperList.size == 0}"/>
             </apex:outputPanel>
             
             <div align="center"> 
                 <apex:commandButton value="Create without Sending" action="{!createWithoutSending}" />
                 <apex:commandButton value="Send without Attachments" action="{!sendWithoutAttachment}" />
<!--                 <apex:commandButton value="Send All Attachments" action="{!sendAllAttachments}" /> -->
                 <apex:commandButton value="Send with Attachments" action="{!sendSelectedAttachments}" />
                 <apex:commandButton value="Cancel" action="{!cancel}"/>
                 <apex:commandButton value="Add Attachments" action="{!openAttachment}"/>
                 
<!--                 action="{!getAvailableAttachments}" -->
<!--                                                     onclick="openAttachmentPage()" /> -->
             </div>
             
        </apex:pageBlock>
        <apex:pageBlock rendered="{!showThankYouPage}">
             <apex:outputPanel rendered="{!applicationSentToPgm.size > 0}">
              <apex:outputText value="{!$Label.Submission_MailSent}" style="color:Green; font-weight: bold; " rendered="{!IF(contains(channelVal,'Create without Sending'),false,true)}"/>
              <apex:outputText value="{!$Label.Submission_MailSent1}" style="color:Green; font-weight: bold; " rendered="{!IF(contains(channelVal,'Create without Sending'),true,false)}"/> 
             <apex:pageBlockTable value="{!applicationSentToPgm}" var="pgms">
                <apex:column headerValue="Program Name">
                    <apex:image url="{!URLFOR($Resource.SubmissionWizard,'SubmissionWizard/Sent.jpg')}" width="20" height="20"/>&nbsp;&nbsp;
                    <a href="{!URLFOR($Action.Program__c.View,pgms.Id, null,true)}">{!pgms.Name}</a>
                </apex:column>
                <apex:column value="{!pgms.Bank__c}"/>
                <!--  <apex:column value="{!pgms.Funder__c}"/>-->
                <apex:column value="{!pgms.Submission_Email__c}"/>
                <apex:column headerValue="Status">
                    <apex:outputLabel value="UW" />
                </apex:column>
             </apex:pageBlockTable>
             <br/>
             </apex:outputPanel>
             
             <apex:outputPanel rendered="{!applicationNotSentToPgm.size > 0}">
             <apex:outputText value="{!$Label.Submission_MailNotSent}" rendered="{!isNoEmailError}" 
                              style="color:Red; font-weight: bold; "/>
               <apex:outputText value="{!$Label.Submission_MailNotSentFunder}" rendered="{!isFunderError}"
                              style="color:Red; font-weight: bold; "  /> 
             <apex:pageBlockTable value="{!applicationNotSentToPgm}" var="pgms">
                <apex:column headerValue="Program Name">
                    <apex:image url="{!URLFOR($Resource.SubmissionWizard,'SubmissionWizard/NotSent.jpg')}" width="16" height="16"/>&nbsp;&nbsp;
                    <a href="{!URLFOR($Action.Program__c.View,pgms.Id, null,true)}">{!pgms.Name}</a>
                </apex:column>
                <apex:column value="{!pgms.Bank__c}"/>
                <!--<apex:column value="{!pgms.Funder__c}"/> -->
                <apex:column value="{!pgms.Submission_Email__c}"/>
                <apex:column headerValue="Status">
                    <apex:outputLabel value="UW" />
                </apex:column>

             </apex:pageBlockTable>
             </apex:outputPanel>
             
             <apex:outputLink value="{!URLFOR($Action.Opportunity.View,oppId, null,true)}"> <apex:outputText value="<< Back to Opportunity"/> </apex:outputLink>
        
        </apex:pageBlock>
        <apex:actionStatus id="loadingAttachment" layout="block">
            <apex:facet name="start">
                <div id="assign-action-spinner-main">
                    <div id="assign-action-spinner-content">
                        <img src="/img/analytics/reportbuilder/icons/spinner32.gif" alt="Processing..." title="Processing..." /> 
                        <p>Processing...</p>
                    </div>
                </div>
            </apex:facet>
        </apex:actionStatus>
        
        <apex:actionFunction action="{!CollectData}" name="collectDataBase64" reRender="form" status="loadingAttachment">
            <apex:param name="data" id="data" value="" />
            <apex:param name="name" id="name" value="" />
        
        </apex:actionFunction>
        <script type="text/javascript">
        var fName = new Array();
        var dropbox = document.getElementById('dropbox');
        var count = 0;
        // # Using an EventListener object
        var dropListener = {
    
            handleEvent: function(event){
                if (event.type === 'dragenter') { this.onDragEnter(event); }
                if (event.type === 'dragexit') { this.onDragExit(event); }
                if (event.type === 'dragover') { this.onDragOver(event); }
                if (event.type === 'drop') { this.onDragDrop(event); }
            },
    
            onDragEnter: function(event){
                event.preventDefault();
                event.stopPropagation();
                console.debug('enter')
            },
    
            onDragExit: function(event){
                event.preventDefault();
                event.stopPropagation();
            },
    
            onDragOver: function(event){
                event.preventDefault();
                event.stopPropagation();
            },
    
            onDragDrop: function(event){
                event.preventDefault();
                event.stopPropagation();
            
                var files = event.dataTransfer.files,
                file = files;
                if (files.length == 1 ) {
                    console.log('11111111111'+files[0].size);
                    document.getElementById('droplabel').innerHTML ='Uploading ' + files[0].name;
                }else if (files.length  >  1) {
                    document.getElementById('droplabel').innerHTML ='Uploading ' + files.length + ' files';
                }
                if (files.length) {
                    for (i = 0; i < files.length; i++) { 
                        file = files[i];
                        //document.getElementById('droplabel').innerHTML = 'Uploading ' + file.name;                        
                        this.processImage(file, i);
                    }
                }
            },
    
            processImage: function(file, i){
                fName.push(file.name);
                
                if (! file.type.match('image.*')) {
                    //document.getElementById('droplabel').innerHTML ='Uploading ' + file.name;
                   // return;
                }
    
                var reader = new FileReader();
            
                reader.onloadend = this.onReaderLoadEnd;
                reader.readAsDataURL(file);
            },
            
            onReaderLoadEnd: function(event){
                var img = document.getElementById("preview");
                img.src = event.target.result;
                collectDataBase64(img.src, fName[count]);
                count++;
            }
        };
    
        // ## Adding drag and drop event listeners
    
        dropbox.addEventListener('dragenter', dropListener, false);
        dropbox.addEventListener('dragexit', dropListener, false);
        dropbox.addEventListener('dragover', dropListener, false);
        dropbox.addEventListener('drop', dropListener, false);
    
    </script>
    </apex:form>

</apex:page>