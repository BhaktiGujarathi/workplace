<apex:page controller="ondeck.OnDeckComponentController" cache="true" contentType="application/vnd.ms-excel#OnDeckOffers.xls" showheader="false" sidebar="false" >

    <h1 style="font-size: large;">
        OnDeck Pre-Approved Offers
    </h1>
    <apex:dataTable value="{!responseWrapper.offers}" border="1" var="offer" title="OnDeck Pre-Approved Offers">
           
		    <apex:column headerValue="Product" style="{!if(offer.productName='Best Offer', 'background-color: #B1D978', '')}">
                <apex:outputText value="{!offer.productName}"  />
            </apex:column>
            
            <apex:column headerValue="Term" style="{!if(offer.productName='Best Offer', 'background-color: #B1D978', '')}">
                <apex:outputText value="{!offer.term}" />
            </apex:column>
            
            <apex:column headerValue="Loan Amount" style="{!if(offer.productName='Best Offer', 'background-color: #B1D978', '')}" >
                <apex:outputText value="{0,number,$#,###,###.00}" >
                    <apex:param value="{!offer.loanAmount}" />
                          </apex:outputText>
            </apex:column>
            
            <apex:column headerValue="Payment Plans" style="{!if(offer.productName='Best Offer', 'background-color: #B1D978', '')}" width="15%" >
                <apex:outputText value="{!offer.paymentPlans}" />
            </apex:column>
            
            <apex:column headerValue="Buy Rate" style="{!if(offer.productName='Best Offer', 'background-color: #B1D978', '')}" >
            
                <apex:outputText value="{0,number,$#,###,###.00}" >
                    <apex:param value="{!offer.buyRate}" />
                          </apex:outputText>
            </apex:column>
            
            <apex:column headerValue="Sell Rate" style="{!if(offer.productName='Best Offer', 'background-color: #B1D978', '')}" >
                <apex:outputText value="{0,number,$#,###,###.00}" style="text-align: right;" >
                    <apex:param value="{!offer.sellRate}" />
                          </apex:outputText>
            </apex:column>
    </apex:dataTable>

</apex:page>